<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-07-28T16:55:43.81749"><title>Hors-S&eacute;rie : Patterns de Persistance et ORM | Java-design-pattern</title><script type="application/json" id="virtual-toc-data">[{"id":"objectifs-p-dagogiques","level":0,"title":"Objectifs Pédagogiques","anchor":"#objectifs-p-dagogiques"},{"id":"introduction-le-pont-entre-deux-mondes","level":0,"title":"Introduction : Le Pont entre Deux Mondes","anchor":"#introduction-le-pont-entre-deux-mondes"},{"id":"l-essentiel-les-deux-grandes-philosophies","level":0,"title":"L\u0027essentiel : Les Deux Grandes Philosophies","anchor":"#l-essentiel-les-deux-grandes-philosophies"},{"id":"pour-aller-plus-loin-les-patterns-d-acc-s-aux-donn-es","level":0,"title":"Pour aller plus loin : Les Patterns d\u0027Accès aux Données","anchor":"#pour-aller-plus-loin-les-patterns-d-acc-s-aux-donn-es"},{"id":"auto-valuation","level":0,"title":"Auto-évaluation","anchor":"#auto-valuation"},{"id":"conclusion","level":0,"title":"Conclusion","anchor":"#conclusion"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Hors-S&eacute;rie : Patterns de Persistance et ORM | Java-design-pattern"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Java-design-pattern Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/007-00-database-patterns.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Hors-S&eacute;rie : Patterns de Persistance et ORM | Java-design-pattern"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/007-00-database-patterns.html#webpage",
    "url": "writerside-documentation/007-00-database-patterns.html",
    "name": "Hors-S&eacute;rie : Patterns de Persistance et ORM | Java-design-pattern",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Java-design-pattern Help"
}</script><!-- End Schema.org --></head><body data-id="007-00-database-patterns" data-main-title="Hors-Série : Patterns de Persistance et ORM" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Java-design-pattern  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="007-00-database-patterns" id="007-00-database-patterns.md">Hors-Série : Patterns de Persistance et ORM</h1><section class="chapter"><h2 id="objectifs-p-dagogiques" data-toc="objectifs-p-dagogiques">Objectifs P&eacute;dagogiques</h2><p id="-t04n1l_9">&Agrave; la fin de ce module, vous serez en mesure de :</p><ul class="list _bullet" id="-t04n1l_10"><li class="list__item" id="-t04n1l_11"><p id="-t04n1l_16"><span class="control" id="-t04n1l_17">D&eacute;finir</span> ce qu'est un ORM et le probl&egrave;me qu'il r&eacute;sout.</p></li><li class="list__item" id="-t04n1l_12"><p id="-t04n1l_18"><span class="control" id="-t04n1l_19">Distinguer</span> les deux principaux patterns de persistance d'objets : <span class="control" id="-t04n1l_20">Active Record</span> et <span class="control" id="-t04n1l_21">Data Mapper</span>.</p></li><li class="list__item" id="-t04n1l_13"><p id="-t04n1l_22"><span class="control" id="-t04n1l_23">Expliquer</span> pourquoi l'&eacute;cosyst&egrave;me Java (avec JPA/Hibernate) a massivement adopt&eacute; le pattern Data Mapper.</p></li><li class="list__item" id="-t04n1l_14"><p id="-t04n1l_24"><span class="control" id="-t04n1l_25">Comprendre</span> les r&ocirc;les des patterns <span class="control" id="-t04n1l_26">DAO (Data Access Object)</span> et <span class="control" id="-t04n1l_27">Repository</span>.</p></li><li class="list__item" id="-t04n1l_15"><p id="-t04n1l_28"><span class="control" id="-t04n1l_29">Reconna&icirc;tre</span> comment Spring Data JPA impl&eacute;mente et &eacute;tend ces patterns pour nous simplifier la vie.</p></li></ul></section><section class="chapter"><h2 id="introduction-le-pont-entre-deux-mondes" data-toc="introduction-le-pont-entre-deux-mondes">Introduction : Le Pont entre Deux Mondes</h2><p id="-t04n1l_30">Dans une application, nous vivons dans un monde d'objets : des <code class="code" id="-t04n1l_33">Book</code>, des <code class="code" id="-t04n1l_34">Author</code>, avec des m&eacute;thodes, des relations et des comportements. Mais nos donn&eacute;es, elles, vivent dans un monde de tables, de lignes et de colonnes : le monde relationnel des bases de donn&eacute;es SQL.</p><p id="-t04n1l_31">Ces deux mondes ne parlent pas la m&ecirc;me langue. Historiquement, les d&eacute;veloppeurs passaient un temps fou &agrave; &eacute;crire du code de &quot;traduction&quot; r&eacute;p&eacute;titif (le fameux code JDBC) pour faire le pont entre ces deux univers. C'est le probl&egrave;me de l' <span class="control" id="-t04n1l_35">&quot; impedance mismatch&quot; objet-relationnel</span>.</p><p id="-t04n1l_32">Un <span class="control" id="-t04n1l_36">ORM (Object-Relational Mapping)</span> est un outil qui construit ce pont pour nous. Et comme pour tout probl&egrave;me de conception, il existe des <span class="control" id="-t04n1l_37">patterns</span> pour construire ce pont. Comprendre ces patterns, c'est comprendre le fonctionnement profond de JPA/Hibernate et savoir pourquoi notre code de persistance est structur&eacute; comme il l'est.</p></section><section class="chapter"><h2 id="l-essentiel-les-deux-grandes-philosophies" data-toc="l-essentiel-les-deux-grandes-philosophies">L'essentiel : Les Deux Grandes Philosophies</h2><p id="-t04n1l_38">Il existe deux approches radicalement diff&eacute;rentes pour mapper les objets &agrave; la base de donn&eacute;es.</p><section class="chapter"><h3 id="le-pattern-active-record" data-toc="le-pattern-active-record">Le Pattern Active Record</h3><section class="chapter"><h4 id="l-intention_1" data-toc="l-intention_1">L'intention</h4><p id="-t04n1l_43"><span class="control" id="-t04n1l_45">Un objet encapsule &agrave; la fois les donn&eacute;es (ses attributs) et le comportement de persistance (CRUD - Create, Read, Update, Delete).</span></p><p id="-t04n1l_44">Dans ce pattern, l'objet m&eacute;tier <span class="emphasis" id="-t04n1l_46">sait</span> comment se sauvegarder, se supprimer ou se retrouver en base. C'est un objet autonome, un v&eacute;ritable couteau suisse pour ses propres donn&eacute;es.</p></section><section class="chapter"><h4 id="structure-et-impl-mentation_1" data-toc="structure-et-impl-mentation_1">Structure et Impl&eacute;mentation</h4><section class="chapter"><h5 id="diagramme-uml_1" data-toc="diagramme-uml_1">Diagramme UML</h5><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="503px" preserveAspectRatio="none" style="width:292px;height:503px;background:#FFFFFF;" version="1.1" viewBox="0 0 292 503" width="292px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="155" x="61.5" y="23.5352">Pattern Active Record</text><!--cluster Base de Donn?es--><g id="cluster_Base de Donn&#233;es"><path d="M64,375.8383 C64,365.8383 146,365.8383 146,365.8383 C146,365.8383 228,365.8383 228,375.8383 L228,476.3283 C228,486.3283 146,486.3283 146,486.3283 C146,486.3283 64,486.3283 64,476.3283 L64,375.8383 " fill="#00FFFF" style="stroke:#454645;stroke-width:1.0;"/><path d="M64,375.8383 C64,385.8383 146,385.8383 146,385.8383 C146,385.8383 228,385.8383 228,375.8383 " fill="none" style="stroke:#454645;stroke-width:1.0;"/><text fill="#454645" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="122" x="85" y="401.3734">Base de Donn&#233;es</text></g><!--entity Table 'product'--><g id="elem_Table 'product'"><path d="M83.5,415.8383 L122.5,415.8383 A5.25,5.25 0 0 1 126,419.3383 L133,436.8383 L208.5,436.8383 A3.5,3.5 0 0 1 212,440.3383 L212,466.8266 A3.5,3.5 0 0 1 208.5,470.3266 L83.5,470.3266 A3.5,3.5 0 0 1 80,466.8266 L80,419.3383 A3.5,3.5 0 0 1 83.5,415.8383 " fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="80" x2="133" y1="436.8383" y2="436.8383"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="90" y="457.3734">Table 'product'</text></g><!--class Product--><g id="elem_Product"><rect codeLine="5" fill="#F1F1F1" height="258.3477" id="Product" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="278" x="7" y="44.4883"/><ellipse cx="115.25" cy="60.4883" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M118.2231,66.1313 Q117.6421,66.4302 117.0029,66.5796 Q116.3638,66.729 115.6582,66.729 Q113.1514,66.729 111.8315,65.0771 Q110.5117,63.4253 110.5117,60.3042 Q110.5117,57.1748 111.8315,55.5229 Q113.1514,53.8711 115.6582,53.8711 Q116.3638,53.8711 117.0112,54.0205 Q117.6587,54.1699 118.2231,54.4688 L118.2231,57.1914 Q117.5923,56.6104 116.9988,56.3406 Q116.4053,56.0708 115.7744,56.0708 Q114.4297,56.0708 113.7449,57.1375 Q113.0601,58.2041 113.0601,60.3042 Q113.0601,62.396 113.7449,63.4626 Q114.4297,64.5293 115.7744,64.5293 Q116.4053,64.5293 116.9988,64.2595 Q117.5923,63.9897 118.2231,63.4087 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="135.75" y="65.7793">Product</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="284" y1="76.4883" y2="76.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="27" y="114.5117">&#160;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="124.209"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="27" y="131">id: Long</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="140.6973"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="27" y="147.4883">name: String</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="157.1855"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90" x="27" y="163.9766">price: double</text><line style="stroke:#181818;stroke-width:1.0;" x1="27" x2="27" y1="175.1738" y2="175.1738"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="31" y="179.9648">comportement m&#233;tier</text><line style="stroke:#181818;stroke-width:1.0;" x1="184" x2="184" y1="175.1738" y2="175.1738"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="27" y="196.9531">&#160;</text><ellipse cx="18" cy="209.6504" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="252" x="27" y="213.4414">applyDiscount(percent: double): void</text><line style="stroke:#181818;stroke-width:1.0;" x1="27" x2="27" y1="224.6387" y2="224.6387"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="204" x="31" y="229.4297">comportement de persistance</text><line style="stroke:#181818;stroke-width:1.0;" x1="239" x2="239" y1="224.6387" y2="224.6387"/><ellipse cx="18" cy="242.627" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="181" x="27" y="246.418">findById(id: Long): Product</text><ellipse cx="18" cy="259.1152" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="161" x="27" y="262.9063">findAll(): List&lt;Product&gt;</text><ellipse cx="18" cy="275.6035" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="27" y="279.3945">save(): void</text><ellipse cx="18" cy="292.0918" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="27" y="295.8828">delete(): void</text><line style="stroke:#181818;stroke-width:1.0;" x1="8" x2="116.5" y1="92.7324" y2="92.7324"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="116.5" y="97.5234">donn&#233;es</text><line style="stroke:#181818;stroke-width:1.0;" x1="175.5" x2="284" y1="92.7324" y2="92.7324"/></g><!--link Product to Table 'product'--><g id="link_Product_Table 'product'"><path codeLine="26" d="M146,309.2883 C146,351.6983 146,403.7983 146,430.4783 " fill="none" id="Product-Table 'product'" style="stroke:#454645;stroke-width:1.0;"/><polygon fill="#454645" points="146,303.2883,142,312.2883,146,308.2883,150,312.2883,146,303.2883" style="stroke:#454645;stroke-width:1.0;"/><polygon fill="#454645" points="146,436.4783,150,427.4783,146,431.4783,142,427.4783,146,436.4783" style="stroke:#454645;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="147" y="346.4066">interagit directement</text></g><!--SRC=[RL51QiCm4Bph5LjVucBq0HC22RaKSWXjFo1BctH1beoqDeJW1-KT-LZNYKsX187GQ4UpEwCt_i4MOQ0ccS2AYJr2SJJCc09iBTE0y8as9bSePRt96OufkjuoN9NMu688znjcq5ef3UHgECHmbcCmBTRmnOaUi4ja1RlODnuL21ziRBkOM0O83EtzneJfeLE1wJf_sLEsiGzSTfYiS9RNxpKCaTmB4OSWt4oPJR0uQLLm5S1aHpXHSBlBXokN8KLdzlAVjlM-bEf1XDOpPIESR0Oib-wLTFF8VnS0erBEi6bCbX1tqou3xUU42Wdi5BqJZyMt4HkmwfxIgwaqob9Bj6kjDozODL2GZp5d4gkKq3vj_m80]--></g></svg></div></section><section class="chapter"><h5 id="exemple-conceptuel" data-toc="exemple-conceptuel">Exemple Conceptuel</h5><aside class="prompt" data-type="warning" data-title="Attention !" id="-t04n1l_50"><p>Ce code est un exemple conceptuel. Ce n'est **PAS** comme cela que l'on fait avec JPA/Hibernate. Il est ici pour illustrer le principe.</p></aside><div class="code-block" data-lang="java">
// Exemple conceptuel du pattern Active Record
public class ProductRecord {
    private Long id;
    private String name;
    private double price;

    // Getters et Setters...

    public void save() {
        // Le code JDBC pour faire un INSERT ou un UPDATE serait ici.
        // L'objet utilise une connexion à la BDD pour se sauvegarder lui-même.
        System.out.println(&quot;Sauvegarde de &quot; + this.name + &quot; en base...&quot;);
        // Ex: if (this.id == null) { INSERT ... } else { UPDATE ... }
    }

    public void delete() {
        // Le code JDBC pour faire un DELETE serait ici.
        System.out.println(&quot;Suppression de &quot; + this.name + &quot; de la base...&quot;);
    }

    public static ProductRecord findById(Long id) {
        // Le code JDBC pour faire un SELECT ... WHERE id = ? serait ici.
        System.out.println(&quot;Recherche du produit &quot; + id);
        return new ProductRecord(); // Simule le retour de l'objet trouvé
    }
}
</div><ul class="list _bullet" id="-t04n1l_52"><li class="list__item" id="-t04n1l_53"><p id="-t04n1l_55"><span class="control" id="-t04n1l_56">Avantages :</span> Tr&egrave;s simple &agrave; comprendre et &agrave; utiliser pour des applications CRUD basiques. La logique est directement sur l'objet, c'est rapide &agrave; d&eacute;velopper.</p></li><li class="list__item" id="-t04n1l_54"><p id="-t04n1l_57"><span class="control" id="-t04n1l_58">Inconv&eacute;nients :</span> Viole le <span class="control" id="-t04n1l_59">Principe de Responsabilit&eacute; Unique (SRP)</span>. L'objet m&eacute;tier (<code class="code" id="-t04n1l_60">Product</code>) est maintenant aussi responsable de sa persistance. Cela m&eacute;lange la logique m&eacute;tier et la logique d'acc&egrave;s aux donn&eacute;es, ce qui rend l'objet difficile &agrave; tester (il faut une base de donn&eacute;es pour tester une m&eacute;thode m&eacute;tier) et &agrave; maintenir dans des domaines complexes.</p></li></ul></section></section></section><section class="chapter"><h3 id="le-pattern-data-mapper" data-toc="le-pattern-data-mapper">Le Pattern Data Mapper</h3><section class="chapter"><h4 id="l-intention" data-toc="l-intention">L'intention</h4><p id="-t04n1l_63"><span class="control" id="-t04n1l_66">Cr&eacute;er une couche de &quot;mappage&quot; s&eacute;par&eacute;e qui est responsable de la synchronisation entre les objets en m&eacute;moire et la base de donn&eacute;es.</span></p><p id="-t04n1l_64">Dans ce pattern, les objets m&eacute;tier (les Entit&eacute;s) sont &quot;purs&quot;. Ils ne connaissent rien &agrave; la base de donn&eacute;es. Ce sont de simples POJOs qui contiennent des donn&eacute;es et de la logique m&eacute;tier. Un objet tiers, le <code class="code" id="-t04n1l_67">Mapper</code>, s'occupe de la traduction.</p><p id="-t04n1l_65">C'est la philosophie adopt&eacute;e par <span class="control" id="-t04n1l_68">JPA et Hibernate</span>.</p></section><section class="chapter"><h4 id="structure-et-impl-mentation" data-toc="structure-et-impl-mentation">Structure et Impl&eacute;mentation</h4><section class="chapter"><h5 id="diagramme-uml" data-toc="diagramme-uml">Diagramme UML</h5><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="533px" preserveAspectRatio="none" style="width:665px;height:533px;background:#FFFFFF;" version="1.1" viewBox="0 0 665 533" width="665px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="148" x="251.75" y="23.5352">Pattern Data Mapper</text><!--cluster Base de Donn?es--><g id="cluster_Base de Donn&#233;es"><path d="M216,405.9083 C216,395.9083 288,395.9083 288,395.9083 C288,395.9083 360,395.9083 360,405.9083 L360,506.3983 C360,516.3983 288,516.3983 288,516.3983 C288,516.3983 216,516.3983 216,506.3983 L216,405.9083 " fill="#00FFFF" style="stroke:#454645;stroke-width:1.0;"/><path d="M216,405.9083 C216,415.9083 288,415.9083 288,415.9083 C288,415.9083 360,415.9083 360,405.9083 " fill="none" style="stroke:#454645;stroke-width:1.0;"/><text fill="#454645" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="122" x="227" y="431.4434">Base de Donn&#233;es</text></g><!--entity Table 'book'--><g id="elem_Table 'book'"><path d="M235,445.9083 L274,445.9083 A5.25,5.25 0 0 1 277.5,449.4083 L284.5,466.9083 L341,466.9083 A3.5,3.5 0 0 1 344.5,470.4083 L344.5,496.8966 A3.5,3.5 0 0 1 341,500.3966 L235,500.3966 A3.5,3.5 0 0 1 231.5,496.8966 L231.5,449.4083 A3.5,3.5 0 0 1 235,445.9083 " fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="231.5" x2="284.5" y1="466.9083" y2="466.9083"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="241.5" y="487.4434">Table 'book'</text></g><!--class Client--><g id="elem_Client"><rect codeLine="5" fill="#F1F1F1" height="64.4883" id="Client" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="128" x="7" y="243.6883"/><ellipse cx="47.2" cy="259.6883" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M50.1731,265.3313 Q49.5921,265.6302 48.9529,265.7796 Q48.3138,265.929 47.6082,265.929 Q45.1014,265.929 43.7815,264.2771 Q42.4617,262.6253 42.4617,259.5042 Q42.4617,256.3748 43.7815,254.7229 Q45.1014,253.0711 47.6082,253.0711 Q48.3138,253.0711 48.9612,253.2205 Q49.6087,253.3699 50.1731,253.6688 L50.1731,256.3914 Q49.5423,255.8104 48.9488,255.5406 Q48.3553,255.2708 47.7244,255.2708 Q46.3797,255.2708 45.6949,256.3375 Q45.0101,257.4041 45.0101,259.5042 Q45.0101,261.596 45.6949,262.6626 Q46.3797,263.7293 47.7244,263.7293 Q48.3553,263.7293 48.9488,263.4595 Q49.5423,263.1897 50.1731,262.6087 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="66.8" y="264.9793">Client</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="134" y1="275.6883" y2="275.6883"/><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="134" y1="283.6883" y2="283.6883"/><ellipse cx="18" cy="297.4324" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="27" y="301.2234">doSomething()</text></g><!--class BookEntity--><g id="elem_BookEntity"><rect codeLine="10" fill="#F1F1F1" height="97.4648" id="BookEntity" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="137" x="219.5" y="44.4883"/><ellipse cx="249.35" cy="60.4883" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M252.3231,66.1313 Q251.7421,66.4302 251.1029,66.5796 Q250.4638,66.729 249.7582,66.729 Q247.2514,66.729 245.9315,65.0771 Q244.6117,63.4253 244.6117,60.3042 Q244.6117,57.1748 245.9315,55.5229 Q247.2514,53.8711 249.7582,53.8711 Q250.4638,53.8711 251.1112,54.0205 Q251.7587,54.1699 252.3231,54.4688 L252.3231,57.1914 Q251.6923,56.6104 251.0988,56.3406 Q250.5053,56.0708 249.8744,56.0708 Q248.5297,56.0708 247.8449,57.1375 Q247.1601,58.2041 247.1601,60.3042 Q247.1601,62.396 247.8449,63.4626 Q248.5297,64.5293 249.8744,64.5293 Q250.5053,64.5293 251.0988,64.2595 Q251.6923,63.9897 252.3231,63.4087 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="266.65" y="65.7793">BookEntity</text><line style="stroke:#181818;stroke-width:0.5;" x1="220.5" x2="355.5" y1="76.4883" y2="76.4883"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="227.5" y="87.2324"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="239.5" y="94.0234">id: Long</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="227.5" y="103.7207"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="239.5" y="110.5117">title: String</text><line style="stroke:#181818;stroke-width:0.5;" x1="220.5" x2="355.5" y1="117.4648" y2="117.4648"/><ellipse cx="230.5" cy="131.209" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="239.5" y="135">getTitle(): String</text></g><g id="elem_GMN4"><path d="M391.5,76.4183 L391.5,89.2283 L356.97,93.2283 L391.5,97.2283 L391.5,110.0394 A3.5,3.5 0 0 0 395,113.5394 L655,113.5394 A3.5,3.5 0 0 0 658.5,110.0394 L658.5,82.9183 L648.5,72.9183 L395,72.9183 A3.5,3.5 0 0 0 391.5,76.4183 " fill="#7FFFD4" style="stroke:#454645;stroke-width:1.5;"/><path d="M648.5,72.9183 L648.5,81.1683 A1.75,1.75 0 0 0 650.25,82.9183 L658.5,82.9183 L648.5,72.9183 " fill="#7FFFD4" style="stroke:#454645;stroke-width:1.5;"/><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="397.5" y="90.4866">L'entit&#233; est un simple POJO.</text><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246" x="397.5" y="105.7972">Elle ne conna&#238;t pas la base de donn&#233;es.</text></g><!--class BookMapper--><g id="elem_BookMapper"><rect codeLine="19" fill="#F1F1F1" height="113.9531" id="BookMapper" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="236" x="170" y="218.9583"/><ellipse cx="240.75" cy="234.9583" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M243.7231,240.6013 Q243.1421,240.9002 242.5029,241.0496 Q241.8638,241.199 241.1582,241.199 Q238.6514,241.199 237.3315,239.5471 Q236.0117,237.8953 236.0117,234.7742 Q236.0117,231.6448 237.3315,229.9929 Q238.6514,228.3411 241.1582,228.3411 Q241.8638,228.3411 242.5112,228.4905 Q243.1587,228.6399 243.7231,228.9388 L243.7231,231.6614 Q243.0923,231.0804 242.4988,230.8106 Q241.9053,230.5408 241.2744,230.5408 Q239.9297,230.5408 239.2449,231.6075 Q238.5601,232.6741 238.5601,234.7742 Q238.5601,236.866 239.2449,237.9326 Q239.9297,238.9993 241.2744,238.9993 Q241.9053,238.9993 242.4988,238.7295 Q243.0923,238.4597 243.7231,237.8787 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="261.25" y="240.2493">BookMapper</text><line style="stroke:#181818;stroke-width:0.5;" x1="171" x2="405" y1="250.9583" y2="250.9583"/><line style="stroke:#181818;stroke-width:0.5;" x1="171" x2="405" y1="258.9583" y2="258.9583"/><ellipse cx="181" cy="272.7024" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="200" x="190" y="276.4934">findById(id: Long): BookEntity</text><ellipse cx="181" cy="289.1907" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="201" x="190" y="292.9817">insert(book: BookEntity): void</text><ellipse cx="181" cy="305.679" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210" x="190" y="309.47">update(book: BookEntity): void</text><ellipse cx="181" cy="322.1673" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="204" x="190" y="325.9583">delete(book: BookEntity): void</text></g><g id="elem_GMN8"><path d="M440.5,259.1183 L440.5,271.9383 L406.07,275.9383 L440.5,279.9383 L440.5,292.7394 A3.5,3.5 0 0 0 444,296.2394 L640,296.2394 A3.5,3.5 0 0 0 643.5,292.7394 L643.5,265.6183 L633.5,255.6183 L444,255.6183 A3.5,3.5 0 0 0 440.5,259.1183 " fill="#7FFFD4" style="stroke:#454645;stroke-width:1.5;"/><path d="M633.5,255.6183 L633.5,263.8683 A1.75,1.75 0 0 0 635.25,265.6183 L643.5,265.6183 L633.5,255.6183 " fill="#7FFFD4" style="stroke:#454645;stroke-width:1.5;"/><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="446.5" y="273.1866">Le Mapper contient toute la</text><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="446.5" y="288.4972">logique de persistance (SQL).</text></g><!--link Client to BookMapper--><g id="link_Client_BookMapper"><path codeLine="33" d="M135.42,275.9383 C146.85,275.9383 152.27,275.9383 163.69,275.9383 " fill="none" id="Client-to-BookMapper" style="stroke:#454645;stroke-width:1.0;"/><polygon fill="#454645" points="169.69,275.9383,160.69,271.9383,164.69,275.9383,160.69,279.9383,169.69,275.9383" style="stroke:#454645;stroke-width:1.0;"/></g><!--reverse link BookEntity to BookMapper--><g id="link_BookEntity_BookMapper"><path codeLine="34" d="M288,148.1783 C288,171.6983 288,194.1883 288,218.7383 " fill="none" id="BookEntity-backto-BookMapper" style="stroke:#454645;stroke-width:1.0;"/><polygon fill="#454645" points="288,142.1783,284,151.1783,288,147.1783,292,151.1783,288,142.1783" style="stroke:#454645;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="289" y="185.5266">cr&#233;e/lit</text></g><!--link BookMapper to Table 'book'--><g id="link_BookMapper_Table 'book'"><path codeLine="35" d="M288,339.3983 C288,376.3383 288,426.6383 288,455.3383 " fill="none" id="BookMapper-Table 'book'" style="stroke:#454645;stroke-width:1.0;"/><polygon fill="#454645" points="288,333.3983,284,342.3983,288,338.3983,292,342.3983,288,333.3983" style="stroke:#454645;stroke-width:1.0;"/><polygon fill="#454645" points="288,461.3383,292,452.3383,288,456.3383,284,452.3383,288,461.3383" style="stroke:#454645;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="289" y="376.4766">interagit</text></g><!--SRC=[VL91Ri8m4Bpx5TjS2Af2xr7L0uL3AogeuCZ5YPTWrQpJU8E4AXx4fP_WOzs4j8sg2iK7QtOydXddXhUuGzZRhDB4YYqxX6YXcR4Yc6ZMyABB4gj8gTpf4E3HMII63wLkmVYbto5lBHNnK04SlqbZxz-c96g7XfY0DIdCF1MoRQz8OScLd6f42kHLWyN37xHH0Y3F29KjjYo71zZ8dK-0WQ4c27PNYjN5_7a-MjFKoPuGSa-apvyCfGxWD6Gw81XPWfzF64PzWvTWboGRIsPyU3BnjrCnynj229O2LXndWlKdGjjxQuHGbqOpNY4OT7Y5y4zcxBflOd7REljQvawloVd2ljTjE6446rXJZX0lNsT3IIbUT1i-6dSLJBeA8WcyySw8RBJIcVGsQ2mD6lmed-eUE7debQHwVILrD-eUE8My4k4xPxbFkq-4zkU6L6gK7qiNbhy0]--></g></svg></div><aside class="prompt" data-type="tip" data-title="Qui est le Data Mapper dans JPA/Hibernate ?" id="-t04n1l_71"><p>Le **`EntityManager`** de JPA (ou la `Session` de Hibernate) **est l'impl&eacute;mentation du pattern Data Mapper**. C'est lui qui sait comment transformer vos objets en requ&ecirc;tes SQL et vice-versa.</p></aside><ul class="list _bullet" id="-t04n1l_72"><li class="list__item" id="-t04n1l_74"><p id="-t04n1l_76"><span class="control" id="-t04n1l_77">Avantages :</span> Respecte le <span class="control" id="-t04n1l_78">Principe de Responsabilit&eacute; Unique</span>. Les objets m&eacute;tier sont compl&egrave;tement ind&eacute;pendants de la persistance, ce qui les rend faciles &agrave; tester unitairement. Cette s&eacute;paration permet de g&eacute;rer des mappings complexes et d'optimiser la persistance (gestion de cache, requ&ecirc;tes optimis&eacute;es) sans &quot;polluer&quot; le mod&egrave;le m&eacute;tier.</p></li><li class="list__item" id="-t04n1l_75"><p id="-t04n1l_79"><span class="control" id="-t04n1l_80">Inconv&eacute;nients :</span> Ajoute une couche d'abstraction suppl&eacute;mentaire, ce qui peut sembler plus complexe au premier abord pour des op&eacute;rations CRUD simples.</p></li></ul><div class="tabs" id="-t04n1l_73" data-anchors="[-t04n1l_81]"><div class="tabs__content" data-gtm="tab" id="-t04n1l_81" data-title="Comparaison : Active Record vs. Data Mapper"><div class="table-wrapper"><table class="" id="-t04n1l_82"><tbody></tbody></table></div></div></div></section></section></section></section><section class="chapter"><h2 id="pour-aller-plus-loin-les-patterns-d-acc-s-aux-donn-es" data-toc="pour-aller-plus-loin-les-patterns-d-acc-s-aux-donn-es">Pour aller plus loin : Les Patterns d'Acc&egrave;s aux Donn&eacute;es</h2><p id="-t04n1l_83">Une fois qu'on a choisi la philosophie Data Mapper, on utilise souvent des patterns suppl&eacute;mentaires pour structurer l'acc&egrave;s &agrave; ce mapper.</p><section class="chapter"><h3 id="le-pattern-dao-data-access-object" data-toc="le-pattern-dao-data-access-object">Le Pattern DAO (Data Access Object)</h3><ul class="list _bullet" id="-t04n1l_88"><li class="list__item" id="-t04n1l_90"><p id="-t04n1l_92"><span class="control" id="-t04n1l_93">Intention :</span> Abstraire et encapsuler tous les acc&egrave;s &agrave; la source de donn&eacute;es. Le DAO fournit une interface avec des op&eacute;rations CRUD, cachant les d&eacute;tails de l'impl&eacute;mentation de la persistance (comment on utilise l' <code class="code" id="-t04n1l_94">EntityManager</code>).</p></li><li class="list__item" id="-t04n1l_91"><p id="-t04n1l_95"><span class="control" id="-t04n1l_96">Structure :</span> Typiquement une interface (<code class="code" id="-t04n1l_97">BookDAO</code>) et une ou plusieurs impl&eacute;mentations (<code class="code" id="-t04n1l_98">BookDAOImpl</code>). Le reste de l'application (les services) ne d&eacute;pend que de l'interface.</p></li></ul><div class="code-block" data-lang="java">
// Interface DAO
public interface BookDAO {
    Book findById(long id);

    void save(Book book);
    // ...
}

// Implémentation du DAO avec JPA
public class BookDAOImpl implements BookDAO {
    // Dans un vrai projet, l'EntityManager serait injecté
    private EntityManager em;

    @Override
    public Book findById(long id) {
        return em.find(Book.class, id);
    }
    // ...
}
</div></section><section class="chapter"><h3 id="le-pattern-repository" data-toc="le-pattern-repository">Le Pattern Repository</h3><p id="-t04n1l_99">Le Repository est une &eacute;volution moderne du DAO, popularis&eacute;e par le Domain-Driven Design (DDD).</p><ul class="list _bullet" id="-t04n1l_100"><li class="list__item" id="-t04n1l_102"><p id="-t04n1l_105"><span class="control" id="-t04n1l_106">Intention :</span> Fournir une <span class="control" id="-t04n1l_107">illusion de collection en m&eacute;moire</span> pour les objets du domaine. Le client manipule le Repository comme s'il s'agissait d'une <code class="code" id="-t04n1l_108">List</code> ou d'une <code class="code" id="-t04n1l_109">Map</code>, sans se soucier de la persistance.</p></li><li class="list__item" id="-t04n1l_103"><p id="-t04n1l_110"><span class="control" id="-t04n1l_111">Diff&eacute;rence avec le DAO :</span> Un DAO est souvent centr&eacute; sur une table et expose des op&eacute;rations CRUD de bas niveau. Un Repository est centr&eacute; sur un <span class="control" id="-t04n1l_112">Agr&eacute;gat</span> (un groupe d'objets m&eacute;tier, comme une <code class="code" id="-t04n1l_113">Commande</code> avec ses <code class="code" id="-t04n1l_114">LignesDeCommande</code>) et expose des m&eacute;thodes qui ont un sens m&eacute;tier.</p></li><li class="list__item" id="-t04n1l_104"><p id="-t04n1l_115"><span class="control" id="-t04n1l_116">Exemple :</span> Au lieu de <code class="code" id="-t04n1l_117">save(user)</code> et <code class="code" id="-t04n1l_118">save(address)</code>, un <code class="code" id="-t04n1l_119">UserRepository</code> pourrait avoir une seule m&eacute;thode <code class="code" id="-t04n1l_120">save(user)</code> qui se charge de sauvegarder l'utilisateur <span class="emphasis" id="-t04n1l_121">et</span> son adresse, car ils font partie du m&ecirc;me agr&eacute;gat.</p></li></ul><aside class="prompt" data-type="warning" data-title="Le lien avec Spring Data JPA" id="-t04n1l_101"><p><b id="-t04n1l_122">Spring Data JPA est une impl&eacute;mentation du pattern Repository.</b> Quand vous cr&eacute;ez une interface <code class="code" id="-t04n1l_123">public interface BookRepository extends JpaRepository&lt;Book, Long&gt; { ... }</code>, vous d&eacute;finissez un Repository. Spring se charge de : 1. Fournir une impl&eacute;mentation concr&egrave;te de cette interface &agrave; la vol&eacute;e. 2. Utiliser en interne <code class="code" id="-t04n1l_124">EntityManager</code> (le <b id="-t04n1l_125">Data Mapper</b>) pour ex&eacute;cuter les requ&ecirc;tes. </p><p id="-t04n1l_126">Vous b&eacute;n&eacute;ficiez donc de la puissance de ces patterns sans avoir &agrave; &eacute;crire le code de plomberie !</p></aside></section><section class="chapter"><h3 id="exercice-12-analyse-de-notre-architecture-de-persistance" data-toc="exercice-12-analyse-de-notre-architecture-de-persistance">Exercice 12 : Analyse de notre architecture de persistance</h3><p id="-t04n1l_127">Cet exercice est une pure analyse de notre projet fil rouge. Vous n'avez pas de code &agrave; &eacute;crire, mais des r&eacute;ponses &agrave; formuler.</p><p id="-t04n1l_128"><span class="control" id="-t04n1l_130">Votre mission :</span> En observant les classes <code class="code" id="-t04n1l_131">Book</code>, <code class="code" id="-t04n1l_132">BookRepository</code>, et le framework Spring Data JPA qui les fait fonctionner, r&eacute;pondez aux questions suivantes :</p><ol class="list _decimal" id="-t04n1l_129" type="1"><li class="list__item" id="-t04n1l_133"><p id="-t04n1l_137">Quel pattern principal de mapping objet-relationnel est utilis&eacute; ? Justifiez en d&eacute;crivant le r&ocirc;le de la classe <code class="code" id="-t04n1l_138">Book</code>.</p></li><li class="list__item" id="-t04n1l_134"><p id="-t04n1l_139">Quel pattern d'acc&egrave;s aux donn&eacute;es est repr&eacute;sent&eacute; par l'interface <code class="code" id="-t04n1l_140">BookRepository</code>?</p></li><li class="list__item" id="-t04n1l_135"><p id="-t04n1l_141">Qui joue le r&ocirc;le du &quot;Data Mapper&quot; effectif dans notre application ?</p></li><li class="list__item" id="-t04n1l_136"><p id="-t04n1l_142">Si nous avions suivi le pattern Active Record, quelles sortes de m&eacute;thodes trouverait-on directement dans la classe <code class="code" id="-t04n1l_143">Book</code>?</p></li></ol></section><section class="chapter"><h3 id="correction-exercice-12-collapsible-true" data-toc="correction-exercice-12-collapsible-true">Correction exercice 12 {collapsible='true''}</h3><p id="-t04n1l_144">Excellente analyse ! Voici les r&eacute;ponses qui d&eacute;montrent une compr&eacute;hension profonde de l'architecture.</p><ol class="list _decimal" id="-t04n1l_145" type="1"><li class="list__item" id="-t04n1l_146"><p id="-t04n1l_150"><span class="control" id="-t04n1l_151">Pattern de mapping :</span> Le pattern utilis&eacute; est le <span class="control" id="-t04n1l_152">Data Mapper</span>. La classe <code class="code" id="-t04n1l_153">Book</code> est une simple entit&eacute; (POJO annot&eacute; avec <code class="code" id="-t04n1l_154">@Entity</code>). Elle contient des donn&eacute;es et pourrait contenir de la logique m&eacute;tier, mais elle est compl&egrave;tement ignorante de la mani&egrave;re dont elle est sauvegard&eacute;e. Elle n'a aucune m&eacute;thode <code class="code" id="-t04n1l_155">.save()</code> ou <code class="code" id="-t04n1l_156">.find()</code>. Sa responsabilit&eacute; est purement li&eacute;e au domaine &quot;Livre&quot;.</p></li><li class="list__item" id="-t04n1l_147"><p id="-t04n1l_157"><span class="control" id="-t04n1l_158">Pattern d'acc&egrave;s aux donn&eacute;es :</span> L'interface <code class="code" id="-t04n1l_159">BookRepository</code> repr&eacute;sente le <span class="control" id="-t04n1l_160">Pattern Repository</span>. Elle fournit une abstraction de haut niveau, similaire &agrave; une collection, pour acc&eacute;der aux entit&eacute;s <code class="code" id="-t04n1l_161">Book</code> (ex: <code class="code" id="-t04n1l_162">findAll()</code>, <code class="code" id="-t04n1l_163">findById()</code>, <code class="code" id="-t04n1l_164">save()</code>).</p></li><li class="list__item" id="-t04n1l_148"><p id="-t04n1l_165"><span class="control" id="-t04n1l_166">Le Data Mapper :</span> Dans notre application Spring Boot/JPA, le r&ocirc;le du Data Mapper est jou&eacute; par l' <span class="control" id="-t04n1l_167"><code class="code" id="-t04n1l_171">EntityManager</code> de JPA</span>, qui est impl&eacute;ment&eacute; par la <span class="control" id="-t04n1l_168"><code class="code" id="-t04n1l_172">Session</code> de Hibernate</span> sous le capot. C'est Spring Data qui orchestre l' utilisation de cet <code class="code" id="-t04n1l_169">EntityManager</code> pour nous lorsque nous appelons les m&eacute;thodes de notre <code class="code" id="-t04n1l_170">BookRepository</code>.</p></li><li class="list__item" id="-t04n1l_149"><p id="-t04n1l_173"><span class="control" id="-t04n1l_175">En Active Record :</span> Si nous avions suivi ce pattern, la classe <code class="code" id="-t04n1l_176">Book</code> elle-m&ecirc;me aurait contenu des m&eacute;thodes statiques et d'instance pour la persistance, comme :</p><ul class="list _bullet" id="-t04n1l_174"><li class="list__item" id="-t04n1l_177"><p id="-t04n1l_181"><code class="code" id="-t04n1l_182">public void save()</code></p></li><li class="list__item" id="-t04n1l_178"><p id="-t04n1l_183"><code class="code" id="-t04n1l_184">public void delete()</code></p></li><li class="list__item" id="-t04n1l_179"><p id="-t04n1l_185"><code class="code" id="-t04n1l_186">public static Book findById(Long id)</code></p></li><li class="list__item" id="-t04n1l_180"><p id="-t04n1l_187"><code class="code" id="-t04n1l_188">public static List&lt;Book&gt; findByTitle(String title)</code></p></li></ul></li></ol></section></section><section class="chapter"><h2 id="auto-valuation" data-toc="auto-valuation">Auto-&eacute;valuation</h2><p id="-t04n1l_189">V&eacute;rifiez que vous ma&icirc;trisez bien ces concepts fondamentaux de la persistance.</p><p id="-t04n1l_190"><span class="control" id="-t04n1l_194">Questions &agrave; Choix Multiple (QCM)</span></p><ol class="list _decimal" id="-t04n1l_191" type="1"><li class="list__item" id="-t04n1l_195"><p id="-t04n1l_199">La principale caract&eacute;ristique du pattern Active Record est :</p><ul class="list _bullet" id="-t04n1l_200"><li class="list__item" id="-t04n1l_201"><p id="-t04n1l_205">a) Il s&eacute;pare la logique m&eacute;tier de la logique de persistance.</p></li><li class="list__item" id="-t04n1l_202"><p id="-t04n1l_206">b) Il utilise un objet <code class="code" id="-t04n1l_207">Mapper</code> pour communiquer avec la base de donn&eacute;es.</p></li><li class="list__item" id="-t04n1l_203"><p id="-t04n1l_208">c) L'objet m&eacute;tier contient lui-m&ecirc;me les m&eacute;thodes pour se sauvegarder et se retrouver.</p></li><li class="list__item" id="-t04n1l_204"><p id="-t04n1l_209">d) Il est utilis&eacute; par d&eacute;faut dans Hibernate.</p></li></ul></li><li class="list__item" id="-t04n1l_196"><p id="-t04n1l_210">Lequel de ces patterns est massivement utilis&eacute; par JPA et Hibernate ?</p><ul class="list _bullet" id="-t04n1l_211"><li class="list__item" id="-t04n1l_212"><p id="-t04n1l_216">a) Active Record</p></li><li class="list__item" id="-t04n1l_213"><p id="-t04n1l_217">b) Data Mapper</p></li><li class="list__item" id="-t04n1l_214"><p id="-t04n1l_218">c) Service Locator</p></li><li class="list__item" id="-t04n1l_215"><p id="-t04n1l_219">d) MVC</p></li></ul></li><li class="list__item" id="-t04n1l_197"><p id="-t04n1l_220">Spring Data JPA est une impl&eacute;mentation du pattern...</p><ul class="list _bullet" id="-t04n1l_221"><li class="list__item" id="-t04n1l_222"><p id="-t04n1l_226">a) Active Record</p></li><li class="list__item" id="-t04n1l_223"><p id="-t04n1l_227">b) DAO</p></li><li class="list__item" id="-t04n1l_224"><p id="-t04n1l_228">c) Repository</p></li><li class="list__item" id="-t04n1l_225"><p id="-t04n1l_229">d) Singleton</p></li></ul></li><li class="list__item" id="-t04n1l_198"><p id="-t04n1l_230">Quel est le principal inconv&eacute;nient du pattern Active Record qui a conduit &agrave; la popularit&eacute; du Data Mapper dans les applications complexes ?</p><ul class="list _bullet" id="-t04n1l_231"><li class="list__item" id="-t04n1l_232"><p id="-t04n1l_236">a) Il est trop lent.</p></li><li class="list__item" id="-t04n1l_233"><p id="-t04n1l_237">b) Il est difficile &agrave; apprendre.</p></li><li class="list__item" id="-t04n1l_234"><p id="-t04n1l_238">c) Il viole le Principe de Responsabilit&eacute; Unique (SRP), rendant les objets difficiles &agrave; tester et &agrave; maintenir.</p></li><li class="list__item" id="-t04n1l_235"><p id="-t04n1l_239">d) Il ne fonctionne qu'avec les bases de donn&eacute;es NoSQL.</p></li></ul></li></ol><p id="-t04n1l_192"><span class="control" id="-t04n1l_240">Questions Ouvertes</span></p><ol class="list _decimal" id="-t04n1l_193" type="1" start="5"><li class="list__item" id="-t04n1l_241"><p id="-t04n1l_243">Expliquez pourquoi le pattern Data Mapper facilite grandement les tests unitaires du mod&egrave;le m&eacute;tier (vos entit&eacute;s).</p></li><li class="list__item" id="-t04n1l_242"><p id="-t04n1l_244">Quelle est la diff&eacute;rence conceptuelle entre un DAO et un Repository ?</p></li></ol></section><section class="chapter"><h2 id="conclusion" data-toc="conclusion">Conclusion</h2><p id="-t04n1l_245">Ce plongeon dans les patterns de persistance vous a r&eacute;v&eacute;l&eacute; la m&eacute;canique interne des outils que vous utilisez tous les jours. Vous savez maintenant que votre choix d'utiliser JPA et Spring Data n'est pas anodin : c'est l'adoption d'une philosophie de conception puissante bas&eacute;e sur le <span class="control" id="-t04n1l_250">Data Mapper</span> et le <span class="control" id="-t04n1l_251">Repository</span>.</p><p id="-t04n1l_246">Cette approche, qui favorise la <span class="control" id="-t04n1l_252">s&eacute;paration des pr&eacute;occupations (SoC)</span>, est la cl&eacute; pour construire des applications dont le c&oelig;ur m&eacute;tier est :</p><ul class="list _bullet" id="-t04n1l_247"><li class="list__item" id="-t04n1l_253"><p id="-t04n1l_256"><span class="control" id="-t04n1l_257">Testable</span> ind&eacute;pendamment de la base de donn&eacute;es.</p></li><li class="list__item" id="-t04n1l_254"><p id="-t04n1l_258"><span class="control" id="-t04n1l_259">Flexible</span> pour &eacute;voluer sans &ecirc;tre frein&eacute; par la structure de la persistance.</p></li><li class="list__item" id="-t04n1l_255"><p id="-t04n1l_260"><span class="control" id="-t04n1l_261">Clair</span> et facile &agrave; comprendre, car chaque couche a une responsabilit&eacute; bien d&eacute;finie.</p></li></ul><p id="-t04n1l_248">Cette connaissance vous donne un avantage consid&eacute;rable. Vous n'&ecirc;tes plus un simple utilisateur du framework, vous en comprenez les fondations architecturales.</p><section class="chapter"><h3 id="corrections-de-l-auto-valuation-orm" data-toc="corrections-de-l-auto-valuation-orm">Corrections de l'auto-&eacute;valuation (ORM)</h3><ol class="list _decimal" id="-t04n1l_262" type="1"><li class="list__item" id="-t04n1l_263"><p id="-t04n1l_269">c)</p></li><li class="list__item" id="-t04n1l_264"><p id="-t04n1l_270">b)</p></li><li class="list__item" id="-t04n1l_265"><p id="-t04n1l_271">c)</p></li><li class="list__item" id="-t04n1l_266"><p id="-t04n1l_272">c)</p></li><li class="list__item" id="-t04n1l_267"><p id="-t04n1l_273"><span class="control" id="-t04n1l_274">Data Mapper et tests unitaires :</span> Comme le Data Mapper s&eacute;pare compl&egrave;tement l'entit&eacute; de la base de donn&eacute;es, l'entit&eacute; devient un simple POJO. Pour la tester, on peut simplement l'instancier (<code class="code" id="-t04n1l_275">new Book()</code>), appeler ses m&eacute;thodes m&eacute;tier, et v&eacute;rifier son &eacute;tat avec des assertions, sans avoir besoin de se connecter &agrave; une base de donn&eacute;es ou de mocker des appels SQL. Les tests sont rapides, simples et isol&eacute;s.</p></li><li class="list__item" id="-t04n1l_268"><p id="-t04n1l_276"><span class="control" id="-t04n1l_277">DAO vs. Repository :</span> Un <span class="control" id="-t04n1l_278">DAO</span> est une abstraction de plus bas niveau, souvent mapp&eacute;e 1-pour-1 avec une table de base de donn&eacute;es, exposant des op&eacute;rations techniques (CRUD). Un <span class="control" id="-t04n1l_279">Repository</span> est une abstraction de plus haut niveau, centr&eacute;e sur un agr&eacute;gat du domaine, et exposant des m&eacute;thodes qui ressemblent &agrave; la manipulation d'une collection en m&eacute;moire, cachant davantage la notion de persistance. Le Repository a une s&eacute;mantique plus &quot;m&eacute;tier&quot;.</p></li></ol></section></section><div class="last-modified">26 juillet 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="006-00-modern-patterns.html" class="navigation-links__prev">Hors-S&eacute;rie : Patterns Modernes et d'Architecture</a><a href="008-00-architecture-patterns.html" class="navigation-links__next">Hors-S&eacute;rie : Les Grands Patterns d'Architecture</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>