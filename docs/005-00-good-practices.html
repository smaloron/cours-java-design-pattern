<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-07-28T16:55:43.816934"><title>Application, Bonnes Pratiques et Anti-Patterns | Java-design-pattern</title><script type="application/json" id="virtual-toc-data">[{"id":"objectifs-p-dagogiques","level":0,"title":"Objectifs Pédagogiques","anchor":"#objectifs-p-dagogiques"},{"id":"introduction-de-l-apprenti-l-artisan","level":0,"title":"Introduction : De l\u0027Apprenti à l\u0027Artisan","anchor":"#introduction-de-l-apprenti-l-artisan"},{"id":"l-essentiel-le-grand-refactoring","level":0,"title":"L\u0027essentiel : Le Grand Refactoring","anchor":"#l-essentiel-le-grand-refactoring"},{"id":"pour-aller-plus-loin","level":0,"title":"Pour aller plus loin","anchor":"#pour-aller-plus-loin"},{"id":"auto-valuation","level":0,"title":"Auto-évaluation","anchor":"#auto-valuation"},{"id":"conclusion","level":0,"title":"Conclusion","anchor":"#conclusion"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Application, Bonnes Pratiques et Anti-Patterns | Java-design-pattern"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Java-design-pattern Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/005-00-good-practices.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Application, Bonnes Pratiques et Anti-Patterns | Java-design-pattern"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/005-00-good-practices.html#webpage",
    "url": "writerside-documentation/005-00-good-practices.html",
    "name": "Application, Bonnes Pratiques et Anti-Patterns | Java-design-pattern",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Java-design-pattern Help"
}</script><!-- End Schema.org --></head><body data-id="005-00-good-practices" data-main-title="Application, Bonnes Pratiques et Anti-Patterns" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Java-design-pattern  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="005-00-good-practices" id="005-00-good-practices.md">Application, Bonnes Pratiques et Anti-Patterns</h1><p id="-5k3y2w_2">Absolument. Nous arrivons &agrave; un point crucial de notre formation. Vous avez appris les patterns, mais un artisan n'est pas d&eacute;fini par ses outils, mais par sa capacit&eacute; &agrave; les choisir et &agrave; les utiliser avec sagesse. Ce module est d&eacute;di&eacute; &agrave; cet art.</p><section class="chapter"><h2 id="objectifs-p-dagogiques" data-toc="objectifs-p-dagogiques">Objectifs P&eacute;dagogiques</h2><p id="-5k3y2w_11">&Agrave; la fin de ce module, vous serez capable de :</p><ul class="list _bullet" id="-5k3y2w_12"><li class="list__item" id="-5k3y2w_13"><p id="-5k3y2w_18"><span class="control" id="-5k3y2w_19">Identifier</span> les &quot;code smells&quot; (mauvaises odeurs de code) qui signalent un besoin de refactoring.</p></li><li class="list__item" id="-5k3y2w_14"><p id="-5k3y2w_20"><span class="control" id="-5k3y2w_21">Appliquer</span> plusieurs patterns en combinaison pour r&eacute;soudre un probl&egrave;me de conception complexe.</p></li><li class="list__item" id="-5k3y2w_15"><p id="-5k3y2w_22"><span class="control" id="-5k3y2w_23">Effectuer</span> un refactoring guid&eacute; d'un code legacy vers une solution bas&eacute;e sur des patterns.</p></li><li class="list__item" id="-5k3y2w_16"><p id="-5k3y2w_24"><span class="control" id="-5k3y2w_25">Expliquer</span> les liens profonds entre les patterns et les principes S.O.L.I.D.</p></li><li class="list__item" id="-5k3y2w_17"><p id="-5k3y2w_26"><span class="control" id="-5k3y2w_27">Reconna&icirc;tre</span> et <span class="control" id="-5k3y2w_28">&eacute;viter</span> les anti-patterns courants.</p></li></ul></section><section class="chapter"><h2 id="introduction-de-l-apprenti-l-artisan" data-toc="introduction-de-l-apprenti-l-artisan">Introduction : De l'Apprenti &agrave; l'Artisan</h2><p id="-5k3y2w_29">Imaginez que vous venez de recevoir une magnifique bo&icirc;te &agrave; outils remplie de marteaux, de scies et de tournevis de toutes sortes. C'est formidable ! Mais cela ne fait pas encore de vous un &eacute;b&eacute;niste. Le v&eacute;ritable savoir-faire consiste &agrave; regarder un simple morceau de bois et &agrave; savoir exactement quel outil utiliser, dans quel ordre, pour le transformer en une &oelig;uvre d'art.</p><p id="-5k3y2w_30">C'est l&agrave; que nous en sommes. Vous avez d&eacute;couvert les patterns de Cr&eacute;ation, de Structure et de Comportement. Vous avez les outils. Ce chapitre va vous apprendre &agrave; d&eacute;velopper votre <span class="control" id="-5k3y2w_32">intuition de concepteur</span>. Nous allons prendre un code &quot; malade&quot;, poser un diagnostic, et lui administrer le bon traitement en utilisant nos patterns.</p><p id="-5k3y2w_31">Nous allons &eacute;galement formaliser les liens entre les patterns et les grands principes de conception, et surtout, nous apprendrons &agrave; reconna&icirc;tre les pi&egrave;ges : les fameux <span class="control" id="-5k3y2w_33">anti-patterns</span>, ou l'art d'utiliser le bon outil de la mauvaise mani&egrave;re.</p></section><section class="chapter"><h2 id="l-essentiel-le-grand-refactoring" data-toc="l-essentiel-le-grand-refactoring">L'essentiel : Le Grand Refactoring</h2><p id="-5k3y2w_34">Le refactoring (ou r&eacute;-usinage) est l'acte d'am&eacute;liorer la conception interne d'un code sans en changer le comportement externe. C'est l'un des domaines o&ugrave; les patterns brillent le plus.</p><section class="chapter"><h3 id="tude-de-cas-le-g-n-rateur-de-rapports-infernal" data-toc="tude-de-cas-le-g-n-rateur-de-rapports-infernal">&Eacute;tude de Cas : Le G&eacute;n&eacute;rateur de Rapports Infernal</h3><p id="-5k3y2w_38">Dans notre application de biblioth&egrave;que, la direction demande des rapports. Un premier d&eacute;veloppeur a cr&eacute;&eacute; un service pour cela. Au d&eacute;but, tout allait bien, mais avec les nouvelles demandes, le service est devenu un monstre.</p><p id="-5k3y2w_39">Voici le code &quot;legacy&quot; que nous devons am&eacute;liorer.</p><aside class="prompt" data-type="warning" data-title="Code Smell en vue !" id="-5k3y2w_40"><p>Ce code est volontairement mal con&ccedil;u &agrave; des fins p&eacute;dagogiques. Analysez-le et essayez de rep&eacute;rer les probl&egrave;mes avant de lire la suite.</p></aside><div class="code-block" data-lang="java">
package fr.formation.spring.app.refactoring.bad;

import fr.formation.spring.app.entities.Book;

import java.util.List;

// Un service qui est devenu très difficile à maintenir.
public class BadReportGenerator {

    // Une méthode &quot;Dieu&quot; qui fait tout.
    public void generateReport(String reportType, String format, List&lt;Book&gt; books) {
        System.out.println(&quot;--- DÉBUT DE LA GÉNÉRATION DU RAPPORT ---&quot;);

        String content = &quot;&quot;;

        // Première structure conditionnelle énorme pour le type de rapport
        if (&quot;INVENTORY&quot;.equalsIgnoreCase(reportType)) {
            System.out.println(&quot;Génération du contenu pour le rapport d'inventaire...&quot;);
            StringBuilder sb = new StringBuilder(&quot;Rapport d'inventaire:\n&quot;);
            for (Book book : books) {
                sb.append(&quot;- &quot;).append(book.getTitle())
                        .append(&quot; (ISBN: &quot;).append(book.getIsbn()).append(&quot;)\n&quot;);
            }
            content = sb.toString();
        } else if (&quot;AUTHORS&quot;.equalsIgnoreCase(reportType)) {
            System.out.println(&quot;Génération du contenu pour le rapport des auteurs...&quot;);
            StringBuilder sb = new StringBuilder(&quot;Rapport des auteurs:\n&quot;);
            books.stream()
                    .map(book -&gt; book.getAuthor().getName())
                    .distinct()
                    .forEach(authorName -&gt; sb.append(&quot;- &quot;).append(authorName).append(&quot;\n&quot;));
            content = sb.toString();
        } else {
            content = &quot;Type de rapport non supporté.&quot;;
        }

        // Deuxième structure conditionnelle pour le format de sortie
        if (&quot;HTML&quot;.equalsIgnoreCase(format)) {
            System.out.println(&quot;Formatage en HTML...&quot;);
            String html = &quot;&lt;html&gt;&lt;body&gt;&lt;pre&gt;&quot; + content + &quot;&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;&quot;;
            System.out.println(&quot;Rapport HTML généré :\n&quot; + html);
            // Logique pour sauvegarder le fichier HTML...
        } else if (&quot;PLAINTEXT&quot;.equalsIgnoreCase(format)) {
            System.out.println(&quot;Formatage en Texte brut...&quot;);
            System.out.println(&quot;Rapport Texte généré :\n&quot; + content);
            // Logique pour sauvegarder le fichier .txt...
        } else {
            System.out.println(&quot;Format de sortie non supporté.&quot;);
        }

        System.out.println(&quot;--- FIN DE LA GÉNÉRATION DU RAPPORT ---&quot;);
    }
}
</div><section class="chapter"><h4 id="diagnostic-des-code-smells" data-toc="diagnostic-des-code-smells">Diagnostic des &quot;Code Smells&quot;</h4><ul class="list _bullet" id="-5k3y2w_43"><li class="list__item" id="-5k3y2w_44"><p id="-5k3y2w_48"><span class="control" id="-5k3y2w_49">Long Method :</span> La m&eacute;thode <code class="code" id="-5k3y2w_50">generateReport</code> est beaucoup trop longue et complexe.</p></li><li class="list__item" id="-5k3y2w_45"><p id="-5k3y2w_51"><span class="control" id="-5k3y2w_52">Large Class / God Class :</span> La classe <code class="code" id="-5k3y2w_53">BadReportGenerator</code> a trop de responsabilit&eacute;s : elle conna&icirc;t la logique de <span class="emphasis" id="-5k3y2w_54">chaque</span> type de rapport et de <span class="emphasis" id="-5k3y2w_55">chaque</span> format de sortie. C'est une violation flagrante du <span class="control" id="-5k3y2w_56">Principe de Responsabilit&eacute; Unique (SRP)</span>.</p></li><li class="list__item" id="-5k3y2w_46"><p id="-5k3y2w_57"><span class="control" id="-5k3y2w_58">Switch Statements / Chained If-Else :</span> Les longues cha&icirc;nes de <code class="code" id="-5k3y2w_59">if-else</code> sont un signe clair de violation du * *Principe Ouvert/Ferm&eacute; (OCP)**. Pour ajouter un nouveau type de rapport (ex: &quot;CATEGORIES&quot;) ou un nouveau format (ex: &quot; PDF&quot;), nous devons <span class="control" id="-5k3y2w_60">modifier</span> cette classe, ce qui est risqu&eacute;.</p></li><li class="list__item" id="-5k3y2w_47"><p id="-5k3y2w_61"><span class="control" id="-5k3y2w_62">Couplage Fort :</span> La logique de haut niveau est directement coupl&eacute;e aux d&eacute;tails d'impl&eacute;mentation de chaque rapport et format.</p></li></ul></section></section><section class="chapter"><h3 id="exercice-9-le-grand-refactoring" data-toc="exercice-9-le-grand-refactoring">Exercice 9 : Le Grand Refactoring</h3><p id="-5k3y2w_63">Votre mission, si vous l'acceptez, est de restructurer ce code en appliquant les patterns que nous avons appris.</p><p id="-5k3y2w_64"><span class="control" id="-5k3y2w_66">Cahier des charges :</span></p><ol class="list _decimal" id="-5k3y2w_65" type="1"><li class="list__item" id="-5k3y2w_67"><p id="-5k3y2w_71"><span class="control" id="-5k3y2w_72">G&eacute;rer les formats de sortie :</span> La logique de formatage (HTML, PlainText) est un algorithme interchangeable. Quel pattern utiliser pour la d&eacute;coupler ? Impl&eacute;mentez-le.</p></li><li class="list__item" id="-5k3y2w_68"><p id="-5k3y2w_73"><span class="control" id="-5k3y2w_74">G&eacute;rer les types de rapport :</span> La g&eacute;n&eacute;ration du contenu d'un rapport suit un processus similaire (titre, contenu, etc.) mais les d&eacute;tails diff&egrave;rent. Quel pattern permet de d&eacute;finir un &quot;squelette&quot; d'algorithme tout en laissant les sous-classes remplir les d&eacute;tails ? Impl&eacute;mentez-le.</p></li><li class="list__item" id="-5k3y2w_69"><p id="-5k3y2w_75"><span class="control" id="-5k3y2w_76">Simplifier l'utilisation :</span> Une fois les deux &eacute;tapes pr&eacute;c&eacute;dentes r&eacute;alis&eacute;es, le code client pour choisir le bon rapport et le bon format peut devenir complexe. Quel pattern permet de masquer cette complexit&eacute; derri&egrave;re une interface simple ? Impl&eacute;mentez-le.</p></li><li class="list__item" id="-5k3y2w_70"><p id="-5k3y2w_77">&Eacute;crivez un code client (par exemple, une m&eacute;thode <code class="code" id="-5k3y2w_78">main</code>) qui utilise votre nouvelle structure pour g&eacute;n&eacute;rer un rapport d'inventaire en HTML.</p></li></ol></section><section class="chapter"><h3 id="correction-exercice-9-collapsible-true" data-toc="correction-exercice-9-collapsible-true">Correction exercice 9 {collapsible='true''}</h3><p id="-5k3y2w_79">Excellent ! C'est un exercice de synth&egrave;se parfait. Voici comment nous pouvons d&eacute;manteler le monstre et le reconstruire de mani&egrave;re propre et extensible.</p><p id="-5k3y2w_80">Nous allons cr&eacute;er un nouveau package <code class="code" id="-5k3y2w_85">fr.formation.spring.app.refactoring.good</code>.</p><section class="chapter"><h4 id="tape-1-g-rer-les-formats-de-sortie-avec-le-pattern-strategy" data-toc="tape-1-g-rer-les-formats-de-sortie-avec-le-pattern-strategy">&Eacute;tape 1 : G&eacute;rer les formats de sortie avec le Pattern Strategy</h4><p id="-5k3y2w_86">La logique de formatage est un algorithme que l'on veut pouvoir changer &agrave; la vol&eacute;e. C'est le cas d'usage parfait pour le pattern <span class="control" id="-5k3y2w_89">Strategy</span>.</p><section class="chapter"><h5 id="diagramme-uml" data-toc="diagramme-uml">Diagramme UML</h5><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="240px" preserveAspectRatio="none" style="width:489px;height:240px;background:#FFFFFF;" version="1.1" viewBox="0 0 489 240" width="489px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="244" x="115.5" y="23.5352">Strat&#233;gies de Formatage de Sortie</text><!--class OutputStrategy--><g id="elem_OutputStrategy"><rect codeLine="5" fill="#F1F1F1" height="64.4883" id="OutputStrategy" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="220" x="134" y="44.4883"/><ellipse cx="187.75" cy="60.4883" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M183.6777,56.2534 L183.6777,54.0952 L191.0571,54.0952 L191.0571,56.2534 L188.5918,56.2534 L188.5918,64.3301 L191.0571,64.3301 L191.0571,66.4883 L183.6777,66.4883 L183.6777,64.3301 L186.1431,64.3301 L186.1431,56.2534 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="104" x="208.25" y="65.7793">OutputStrategy</text><line style="stroke:#181818;stroke-width:0.5;" x1="135" x2="353" y1="76.4883" y2="76.4883"/><line style="stroke:#181818;stroke-width:0.5;" x1="135" x2="353" y1="84.4883" y2="84.4883"/><ellipse cx="145" cy="98.2324" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="194" x="154" y="102.0234">format(content: String): void</text></g><!--class HtmlOutputStrategy--><g id="elem_HtmlOutputStrategy"><rect codeLine="10" fill="#F1F1F1" height="64.4883" id="HtmlOutputStrategy" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="220" x="7" y="168.9783"/><ellipse cx="45.4" cy="184.9783" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M48.3731,190.6213 Q47.7921,190.9202 47.1529,191.0696 Q46.5138,191.219 45.8082,191.219 Q43.3014,191.219 41.9815,189.5671 Q40.6617,187.9153 40.6617,184.7942 Q40.6617,181.6648 41.9815,180.0129 Q43.3014,178.3611 45.8082,178.3611 Q46.5138,178.3611 47.1612,178.5105 Q47.8087,178.6599 48.3731,178.9587 L48.3731,181.6814 Q47.7423,181.1004 47.1488,180.8306 Q46.5553,180.5608 45.9244,180.5608 Q44.5797,180.5608 43.8949,181.6275 Q43.2101,182.6941 43.2101,184.7942 Q43.2101,186.886 43.8949,187.9526 Q44.5797,189.0193 45.9244,189.0193 Q46.5553,189.0193 47.1488,188.7495 Q47.7423,188.4797 48.3731,187.8987 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="64.6" y="190.2693">HtmlOutputStrategy</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="226" y1="200.9783" y2="200.9783"/><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="226" y1="208.9783" y2="208.9783"/><ellipse cx="18" cy="222.7224" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="194" x="27" y="226.5134">format(content: String): void</text></g><!--class PlainTextOutputStrategy--><g id="elem_PlainTextOutputStrategy"><rect codeLine="14" fill="#F1F1F1" height="64.4883" id="PlainTextOutputStrategy" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="220" x="262" y="168.9783"/><ellipse cx="286" cy="184.9783" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M288.9731,190.6213 Q288.3921,190.9202 287.7529,191.0696 Q287.1138,191.219 286.4082,191.219 Q283.9014,191.219 282.5815,189.5671 Q281.2617,187.9153 281.2617,184.7942 Q281.2617,181.6648 282.5815,180.0129 Q283.9014,178.3611 286.4082,178.3611 Q287.1138,178.3611 287.7612,178.5105 Q288.4087,178.6599 288.9731,178.9587 L288.9731,181.6814 Q288.3423,181.1004 287.7488,180.8306 Q287.1553,180.5608 286.5244,180.5608 Q285.1797,180.5608 284.4949,181.6275 Q283.8101,182.6941 283.8101,184.7942 Q283.8101,186.886 284.4949,187.9526 Q285.1797,189.0193 286.5244,189.0193 Q287.1553,189.0193 287.7488,188.7495 Q288.3423,188.4797 288.9731,187.8987 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168" x="302" y="190.2693">PlainTextOutputStrategy</text><line style="stroke:#181818;stroke-width:0.5;" x1="263" x2="481" y1="200.9783" y2="200.9783"/><line style="stroke:#181818;stroke-width:0.5;" x1="263" x2="481" y1="208.9783" y2="208.9783"/><ellipse cx="273" cy="222.7224" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="194" x="282" y="226.5134">format(content: String): void</text></g><!--reverse link OutputStrategy to HtmlOutputStrategy--><g id="link_OutputStrategy_HtmlOutputStrategy"><path d="M198.3352,121.7753 C179.3752,140.0653 168.54,150.5183 149.59,168.7883 " fill="none" id="OutputStrategy-backto-HtmlOutputStrategy" style="stroke:#454645;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="211.29,109.2783,194.1696,117.457,202.5009,126.0935,211.29,109.2783" style="stroke:#454645;stroke-width:1.0;"/></g><!--reverse link OutputStrategy to PlainTextOutputStrategy--><g id="link_OutputStrategy_PlainTextOutputStrategy"><path d="M289.9639,121.7242 C309.0739,140.0142 320.06,150.5183 339.15,168.7883 " fill="none" id="OutputStrategy-backto-PlainTextOutputStrategy" style="stroke:#454645;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="none" points="276.96,109.2783,285.8152,126.0588,294.1125,117.3895,276.96,109.2783" style="stroke:#454645;stroke-width:1.0;"/></g><!--SRC=[xLNRRjf047tVhvZc2LGb0c93uwSMY9lI82eWUL_i0LQnT-dkc3Igya7zZlvOnq24nKsGDczTovQyU_QSCpDxUKTJJ17cQcIb9a6A4eIp0Lb9ltzD53g84K9ZKqboWldFm5XIU2Q4qeHsB2E4NaQpZ1QJSF84FuLu3-F5d59a6AKf01vLUb8EO6vKB02UXOWIwHpSK9fi4AXqbh0hJUwLr01Bxc-9L7g8F-W4WUFuFwAEipGHmZqeFPDMfj2KqSF4cap7BPCO2-6Y5G1kAcFpo5Gmbed3maX_ESjgjD0ez7-orZmksJpVgtj-OInaUtk61lWzGntXhHhpgx5fR8ns2QvVvSyEy6UsFhj1oSWZg1VeDUumw_7wI-Hmgg87ZLp0QZ71ReLigxbY5DSAk1N9LtRNtKMcl7ShikUY07z9HMh6E-65VAkczKklSKXthR2g_qup5nlACM-laNIuHxPIsQ0w8BihC5x6YfxsndJj-xNNasj3-tmts7NREudwg7J9Y8pTexd5Ss8uevnAshVALdwgM9Ey6NkIO4JAQBTNmG-zlr3WBPZXlzaT1shz_nuwzHvY2KrttLkOetLSVqvahLAxlAZMIg5Lq8i8QXMe-e5t5VWUjAu7GyW1PL7gVXc2Cvdb3CRAiSWeorTGMNJaN48_uyCZnG1wCzITzjUN3hZMSsMDpksBpdrt3QXxvqr5VB1RzWBtNT76iSmIuXcHYJc40Ew6uVa7SIlr9EDo1Z2seiNhYEnJ067_3m00]--></g></svg></div></section><section class="chapter"><h5 id="le-code" data-toc="le-code">Le code</h5><div class="code-block" data-lang="java">
// OutputStrategy.java
package fr.formation.spring.app.refactoring.good.strategy;

public interface OutputStrategy {
    void format(String content);
}

// HtmlOutputStrategy.java
package fr.formation.spring.app.refactoring.good.strategy;

public class HtmlOutputStrategy implements OutputStrategy {
    @Override
    public void format(String content) {
        String html = &quot;&lt;html&gt;&lt;body&gt;&lt;pre&gt;&quot; + content + &quot;&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;&quot;;
        System.out.println(&quot;Rapport HTML généré :\n&quot; + html);
    }
}

// PlainTextOutputStrategy.java
package fr.formation.spring.app.refactoring.good.strategy;

public class PlainTextOutputStrategy implements OutputStrategy {
    @Override
    public void format(String content) {
        System.out.println(&quot;Rapport Texte généré :\n&quot; + content);
    }
}
</div><p id="-5k3y2w_92"><span class="control" id="-5k3y2w_93">B&eacute;n&eacute;fice :</span> Pour ajouter un format PDF, on cr&eacute;e une classe <code class="code" id="-5k3y2w_94">PdfOutputStrategy</code>. Le reste du code n'est pas impact&eacute;. * <span class="emphasis" id="-5k3y2w_95">OCP respect&eacute; !</span>*</p></section></section><section class="chapter"><h4 id="tape-2-g-rer-les-types-de-rapport-avec-le-pattern-template-method" data-toc="tape-2-g-rer-les-types-de-rapport-avec-le-pattern-template-method">&Eacute;tape 2 : G&eacute;rer les types de rapport avec le Pattern Template Method</h4><p id="-5k3y2w_96">Chaque rapport suit un squelette commun : g&eacute;n&eacute;rer un titre, puis un contenu. C'est le cas d'usage parfait pour le * <span class="emphasis" id="-5k3y2w_99">Template Method</span>*.</p><section class="chapter"><h5 id="diagramme-uml_2" data-toc="diagramme-uml_2">Diagramme UML</h5><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="289px" preserveAspectRatio="none" style="width:711px;height:289px;background:#FFFFFF;" version="1.1" viewBox="0 0 711 289" width="711px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="270" x="213.5" y="23.5352">Patron de M&#233;thode pour les Rapports</text><!--class AbstractReportGenerator--><g id="elem_AbstractReportGenerator"><rect codeLine="4" fill="#F1F1F1" height="97.4648" id="AbstractReportGenerator" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="330" x="191" y="44.4883"/><ellipse cx="265.75" cy="60.4883" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M265.8633,55.8364 L264.7095,60.9082 L267.0254,60.9082 Z M264.3691,53.5952 L267.3657,53.5952 L270.7109,65.9883 L268.2622,65.9883 L267.4985,62.9253 L264.2197,62.9253 L263.4727,65.9883 L261.0239,65.9883 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="172" x="286.25" y="65.7793">AbstractReportGenerator</text><line style="stroke:#181818;stroke-width:0.5;" x1="192" x2="520" y1="76.4883" y2="76.4883"/><line style="stroke:#181818;stroke-width:0.5;" x1="192" x2="520" y1="84.4883" y2="84.4883"/><ellipse cx="202" cy="98.2324" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="293" x="211" y="102.0234">{final} generate(books: List&lt;Book&gt;): String</text><polygon fill="#FFFF44" points="202,109.7207,206,113.7207,202,117.7207,198,113.7207" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="111" x="211" y="118.5117">getTitle(): String</text><polygon fill="#FFFF44" points="202,126.209,206,130.209,202,134.209,198,130.209" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="304" x="211" y="135">generateContent(books: List&lt;Book&gt;): String</text></g><!--class InventoryReportGenerator--><g id="elem_InventoryReportGenerator"><rect codeLine="9" fill="#F1F1F1" height="80.9766" id="InventoryReportGenerator" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="330" x="9" y="201.9483"/><ellipse cx="80.25" cy="217.9483" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M83.2231,223.5913 Q82.6421,223.8902 82.0029,224.0396 Q81.3638,224.189 80.6582,224.189 Q78.1514,224.189 76.8315,222.5371 Q75.5117,220.8853 75.5117,217.7642 Q75.5117,214.6348 76.8315,212.9829 Q78.1514,211.3311 80.6582,211.3311 Q81.3638,211.3311 82.0112,211.4805 Q82.6587,211.6299 83.2231,211.9287 L83.2231,214.6514 Q82.5923,214.0704 81.9988,213.8006 Q81.4053,213.5308 80.7744,213.5308 Q79.4297,213.5308 78.7449,214.5975 Q78.0601,215.6641 78.0601,217.7642 Q78.0601,219.856 78.7449,220.9226 Q79.4297,221.9893 80.7744,221.9893 Q81.4053,221.9893 81.9988,221.7195 Q82.5923,221.4497 83.2231,220.8687 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="179" x="100.75" y="223.2393">InventoryReportGenerator</text><line style="stroke:#181818;stroke-width:0.5;" x1="10" x2="338" y1="233.9483" y2="233.9483"/><line style="stroke:#181818;stroke-width:0.5;" x1="10" x2="338" y1="241.9483" y2="241.9483"/><polygon fill="#FFFF44" points="20,250.6924,24,254.6924,20,258.6924,16,254.6924" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="29" y="259.4834">getTitle(): String</text><polygon fill="#FFFF44" points="20,267.1807,24,271.1807,20,275.1807,16,271.1807" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="304" x="29" y="275.9717">generateContent(books: List&lt;Book&gt;): String</text></g><!--class AuthorsReportGenerator--><g id="elem_AuthorsReportGenerator"><rect codeLine="13" fill="#F1F1F1" height="80.9766" id="AuthorsReportGenerator" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="330" x="374" y="201.9483"/><ellipse cx="449.75" cy="217.9483" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M452.7231,223.5913 Q452.1421,223.8902 451.5029,224.0396 Q450.8638,224.189 450.1582,224.189 Q447.6514,224.189 446.3315,222.5371 Q445.0117,220.8853 445.0117,217.7642 Q445.0117,214.6348 446.3315,212.9829 Q447.6514,211.3311 450.1582,211.3311 Q450.8638,211.3311 451.5112,211.4805 Q452.1587,211.6299 452.7231,211.9287 L452.7231,214.6514 Q452.0923,214.0704 451.4988,213.8006 Q450.9053,213.5308 450.2744,213.5308 Q448.9297,213.5308 448.2449,214.5975 Q447.5601,215.6641 447.5601,217.7642 Q447.5601,219.856 448.2449,220.9226 Q448.9297,221.9893 450.2744,221.9893 Q450.9053,221.9893 451.4988,221.7195 Q452.0923,221.4497 452.7231,220.8687 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170" x="470.25" y="223.2393">AuthorsReportGenerator</text><line style="stroke:#181818;stroke-width:0.5;" x1="375" x2="703" y1="233.9483" y2="233.9483"/><line style="stroke:#181818;stroke-width:0.5;" x1="375" x2="703" y1="241.9483" y2="241.9483"/><polygon fill="#FFFF44" points="385,250.6924,389,254.6924,385,258.6924,381,254.6924" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="394" y="259.4834">getTitle(): String</text><polygon fill="#FFFF44" points="385,267.1807,389,271.1807,385,275.1807,381,271.1807" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="304" x="394" y="275.9717">generateContent(books: List&lt;Book&gt;): String</text></g><!--reverse link AbstractReportGenerator to InventoryReportGenerator--><g id="link_AbstractReportGenerator_InventoryReportGenerator"><path d="M282.4146,153.7477 C258.7746,172.8677 245.91,183.2683 223.39,201.4883 " fill="none" id="AbstractReportGenerator-backto-InventoryReportGenerator" style="stroke:#454645;stroke-width:1.0;"/><polygon fill="none" points="296.41,142.4283,278.6415,149.0826,286.1878,158.4128,296.41,142.4283" style="stroke:#454645;stroke-width:1.0;"/></g><!--reverse link AbstractReportGenerator to AuthorsReportGenerator--><g id="link_AbstractReportGenerator_AuthorsReportGenerator"><path d="M429.9457,153.7102 C453.7157,172.8302 466.69,183.2683 489.34,201.4883 " fill="none" id="AbstractReportGenerator-backto-AuthorsReportGenerator" style="stroke:#454645;stroke-width:1.0;"/><polygon fill="none" points="415.92,142.4283,426.185,158.3854,433.7063,149.035,415.92,142.4283" style="stroke:#454645;stroke-width:1.0;"/></g><!--SRC=[nP112i9034NtFKLiDuetA29K5o8eIFK2qnhRmJefcRGefGVo75xCATMDO1TktFqaFv-NZ2J72qAj4rP6FD5I8FWx9Km6ZWZRnrroSgAaYg502x4gIsAnlgSIAwnIWRHGraBqAcFivYiqo4g8eV40fj2Sj5552rdVnt52TBOXRBILsSBf-II4lR0scVC7qBpJknKvT5pZ0KSVkYGZQ6Gek_LwshMfdPFuzecBLnTn73ud-CRq0qXKkGUp_Hl64m00]--></g></svg></div></section><section class="chapter"><h5 id="le-code_2" data-toc="le-code_2">Le code</h5><div class="code-block" data-lang="java">
// AbstractReportGenerator.java
package fr.formation.spring.app.refactoring.good.templatemethod;

import fr.formation.spring.app.entities.Book;

import java.util.List;

public abstract class AbstractReportGenerator {

    // Le patron de méthode, final pour ne pas être redéfini.
    public final String generate(List&lt;Book&gt; books) {
        StringBuilder report = new StringBuilder();
        report.append(getTitle()).append(&quot;\n&quot;);
        report.append(&quot;----------------------------\n&quot;);
        report.append(generateContent(books));
        return report.toString();
    }

    // Méthodes abstraites que les sous-classes doivent implémenter.
    protected abstract String getTitle();

    protected abstract String generateContent(List&lt;Book&gt; books);
}

// InventoryReportGenerator.java
package fr.formation.spring.app.refactoring.good.templatemethod;

// ...
public class InventoryReportGenerator extends AbstractReportGenerator {
    @Override
    protected String getTitle() {
        return &quot;Rapport d'inventaire&quot;;
    }

    @Override
    protected String generateContent(List&lt;Book&gt; books) {
        StringBuilder sb = new StringBuilder();
        for (Book book : books) {
            sb.append(&quot;- &quot;).append(book.getTitle())
                    .append(&quot; (ISBN: &quot;).append(book.getIsbn()).append(&quot;)\n&quot;);
        }
        return sb.toString();
    }
}

// AuthorsReportGenerator.java
package fr.formation.spring.app.refactoring.good.templatemethod;

// ...
public class AuthorsReportGenerator extends AbstractReportGenerator {
    @Override
    protected String getTitle() {
        return &quot;Rapport des Auteurs&quot;;
    }

    @Override
    protected String generateContent(List&lt;Book&gt; books) {
        StringBuilder sb = new StringBuilder();
        books.stream()
                .map(book -&gt; book.getAuthor().getName())
                .distinct()
                .forEach(name -&gt; sb.append(&quot;- &quot;).append(name).append(&quot;\n&quot;));
        return sb.toString();
    }
}
</div><p id="-5k3y2w_102"><span class="control" id="-5k3y2w_103">B&eacute;n&eacute;fice :</span> Pour ajouter un rapport sur les cat&eacute;gories, on cr&eacute;e <code class="code" id="-5k3y2w_104">CategoryReportGenerator</code>. Le squelette de g&eacute;n&eacute;ration est pr&eacute;serv&eacute;. <span class="control" id="-5k3y2w_105">OCP respect&eacute; !</span></p></section></section><section class="chapter"><h4 id="tape-3-simplifier-l-utilisation-avec-le-pattern-facade" data-toc="tape-3-simplifier-l-utilisation-avec-le-pattern-facade">&Eacute;tape 3 : Simplifier l'utilisation avec le Pattern Facade</h4><p id="-5k3y2w_106">Le client doit maintenant instancier le bon g&eacute;n&eacute;rateur ET la bonne strat&eacute;gie. C'est complexe. On cache tout &ccedil;a derri&egrave;re une <span class="control" id="-5k3y2w_109">Facade</span>.</p><section class="chapter"><h5 id="diagramme-uml_1" data-toc="diagramme-uml_1">Diagramme UML</h5><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="239px" preserveAspectRatio="none" style="width:420px;height:239px;background:#FFFFFF;" version="1.1" viewBox="0 0 420 239" width="420px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="267" x="69.5" y="23.5352">Fa&#231;ade pour le Syst&#232;me de Reporting</text><!--cluster Syst?me de Reporting--><g id="cluster_Syst&#232;me de Reporting"><path d="M9.5,133.9783 L166.5,133.9783 A5.25,5.25 0 0 1 170,137.4783 L177,156.4666 L409.5,156.4666 A3.5,3.5 0 0 1 413,159.9666 L413,229.4783 A3.5,3.5 0 0 1 409.5,232.9783 L9.5,232.9783 A3.5,3.5 0 0 1 6,229.4783 L6,137.4783 A3.5,3.5 0 0 1 9.5,133.9783 " fill="none" style="stroke:#696969;stroke-width:1.0;"/><line style="stroke:#696969;stroke-width:1.0;" x1="6" x2="177" y1="156.4666" y2="156.4666"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="158" x="10" y="149.5134">Syst&#232;me de Reporting</text></g><!--class AbstractReportGenerator--><g id="elem_AbstractReportGenerator"><rect fill="#F1F1F1" height="48" id="AbstractReportGenerator" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="204" x="22" y="168.9783"/><ellipse cx="37" cy="184.9783" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M39.9731,190.6213 Q39.3921,190.9202 38.7529,191.0696 Q38.1138,191.219 37.4082,191.219 Q34.9014,191.219 33.5815,189.5671 Q32.2617,187.9153 32.2617,184.7942 Q32.2617,181.6648 33.5815,180.0129 Q34.9014,178.3611 37.4082,178.3611 Q38.1138,178.3611 38.7612,178.5105 Q39.4087,178.6599 39.9731,178.9588 L39.9731,181.6814 Q39.3423,181.1004 38.7488,180.8306 Q38.1553,180.5608 37.5244,180.5608 Q36.1797,180.5608 35.4949,181.6275 Q34.8101,182.6941 34.8101,184.7942 Q34.8101,186.886 35.4949,187.9526 Q36.1797,189.0193 37.5244,189.0193 Q38.1553,189.0193 38.7488,188.7495 Q39.3423,188.4797 39.9731,187.8987 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="51" y="190.2693">AbstractReportGenerator</text><line style="stroke:#181818;stroke-width:0.5;" x1="23" x2="225" y1="200.9783" y2="200.9783"/><line style="stroke:#181818;stroke-width:0.5;" x1="23" x2="225" y1="208.9783" y2="208.9783"/></g><!--class OutputStrategy--><g id="elem_OutputStrategy"><rect fill="#F1F1F1" height="48" id="OutputStrategy" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="136" x="261" y="168.9783"/><ellipse cx="276" cy="184.9783" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M278.9731,190.6213 Q278.3921,190.9202 277.7529,191.0696 Q277.1138,191.219 276.4082,191.219 Q273.9014,191.219 272.5815,189.5671 Q271.2617,187.9153 271.2617,184.7942 Q271.2617,181.6648 272.5815,180.0129 Q273.9014,178.3611 276.4082,178.3611 Q277.1138,178.3611 277.7612,178.5105 Q278.4087,178.6599 278.9731,178.9588 L278.9731,181.6814 Q278.3423,181.1004 277.7488,180.8306 Q277.1553,180.5608 276.5244,180.5608 Q275.1797,180.5608 274.4949,181.6275 Q273.8101,182.6941 273.8101,184.7942 Q273.8101,186.886 274.4949,187.9526 Q275.1797,189.0193 276.5244,189.0193 Q277.1553,189.0193 277.7488,188.7495 Q278.3423,188.4797 278.9731,187.8987 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="290" y="190.2693">OutputStrategy</text><line style="stroke:#181818;stroke-width:0.5;" x1="262" x2="396" y1="200.9783" y2="200.9783"/><line style="stroke:#181818;stroke-width:0.5;" x1="262" x2="396" y1="208.9783" y2="208.9783"/></g><!--class ReportingFacade--><g id="elem_ReportingFacade"><rect codeLine="4" fill="#F1F1F1" height="64.4883" id="ReportingFacade" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="155" x="148.5" y="44.4883"/><ellipse cx="166.65" cy="60.4883" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M169.6231,66.1313 Q169.0421,66.4302 168.4029,66.5796 Q167.7638,66.729 167.0582,66.729 Q164.5514,66.729 163.2315,65.0771 Q161.9117,63.4253 161.9117,60.3042 Q161.9117,57.1748 163.2315,55.5229 Q164.5514,53.8711 167.0582,53.8711 Q167.7638,53.8711 168.4112,54.0205 Q169.0587,54.1699 169.6231,54.4688 L169.6231,57.1914 Q168.9923,56.6104 168.3988,56.3406 Q167.8053,56.0708 167.1744,56.0708 Q165.8297,56.0708 165.1449,57.1375 Q164.4601,58.2041 164.4601,60.3042 Q164.4601,62.396 165.1449,63.4626 Q165.8297,64.5293 167.1744,64.5293 Q167.8053,64.5293 168.3988,64.2595 Q168.9923,63.9897 169.6231,63.4087 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="181.35" y="65.7793">ReportingFacade</text><line style="stroke:#181818;stroke-width:0.5;" x1="149.5" x2="302.5" y1="76.4883" y2="76.4883"/><line style="stroke:#181818;stroke-width:0.5;" x1="149.5" x2="302.5" y1="84.4883" y2="84.4883"/><ellipse cx="159.5" cy="98.2324" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="168.5" y="102.0234">generateReport(...)</text></g><!--class Client--><g id="elem_Client"><rect fill="#F1F1F1" height="48" id="Client" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="72" x="41" y="52.7383"/><ellipse cx="56" cy="68.7383" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M58.9731,74.3813 Q58.3921,74.6802 57.7529,74.8296 Q57.1138,74.979 56.4082,74.979 Q53.9014,74.979 52.5815,73.3271 Q51.2617,71.6753 51.2617,68.5542 Q51.2617,65.4248 52.5815,63.7729 Q53.9014,62.1211 56.4082,62.1211 Q57.1138,62.1211 57.7612,62.2705 Q58.4087,62.4199 58.9731,62.7188 L58.9731,65.4414 Q58.3423,64.8604 57.7488,64.5906 Q57.1553,64.3208 56.5244,64.3208 Q55.1797,64.3208 54.4949,65.3875 Q53.8101,66.4541 53.8101,68.5542 Q53.8101,70.646 54.4949,71.7126 Q55.1797,72.7793 56.5244,72.7793 Q57.1553,72.7793 57.7488,72.5095 Q58.3423,72.2397 58.9731,71.6587 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="70" y="74.0293">Client</text><line style="stroke:#181818;stroke-width:0.5;" x1="42" x2="112" y1="84.7383" y2="84.7383"/><line style="stroke:#181818;stroke-width:0.5;" x1="42" x2="112" y1="92.7383" y2="92.7383"/></g><!--link Client to ReportingFacade--><g id="link_Client_ReportingFacade"><path codeLine="7" d="M113.38,76.7383 C124.96,76.7383 130.55,76.7383 142.13,76.7383 " fill="none" id="Client-to-ReportingFacade" style="stroke:#454645;stroke-width:1.0;"/><polygon fill="#454645" points="148.13,76.7383,139.13,72.7383,143.13,76.7383,139.13,80.7383,148.13,76.7383" style="stroke:#454645;stroke-width:1.0;"/></g><!--link ReportingFacade to AbstractReportGenerator--><g id="link_ReportingFacade_AbstractReportGenerator"><path codeLine="10" d="M197.86,109.2583 C181.11,128.0083 164.2154,146.9321 148.9254,164.0621 " fill="none" id="ReportingFacade-to-AbstractReportGenerator" style="stroke:#454645;stroke-width:1.0;"/><polygon fill="#454645" points="144.93,168.5383,153.9073,164.4876,148.2595,164.8081,147.939,159.1603,144.93,168.5383" style="stroke:#454645;stroke-width:1.0;"/></g><!--link ReportingFacade to OutputStrategy--><g id="link_ReportingFacade_OutputStrategy"><path codeLine="11" d="M254.42,109.2583 C271.33,128.0083 288.4143,146.9502 303.8443,164.0802 " fill="none" id="ReportingFacade-to-OutputStrategy" style="stroke:#454645;stroke-width:1.0;"/><polygon fill="#454645" points="307.86,168.5383,304.8086,159.1741,304.5136,164.8232,298.8645,164.5283,307.86,168.5383" style="stroke:#454645;stroke-width:1.0;"/></g><!--SRC=[ROvD2i8m48NtSugnAqMQ8mWYrALWJp2DGmp6D2HJeKZFe_VenKpfGYZTlh_lRUJEJyQNRI9v0R7Y68kAnW_T64FRHSn2tISPlpcNjIk7DehrfW3jAAM_K96UIcz0tADXpv64PtUhbDh102TdsGkMXsKB891-aCdmTLYUNOBAF7DiaaJICdld6Th6rUobaz19BTCjqyFm0m00]--></g></svg></div></section><section class="chapter"><h5 id="le-code_1" data-toc="le-code_1">Le code</h5><div class="code-block" data-lang="java">
// ReportingFacade.java
package fr.formation.spring.app.refactoring.good;

import fr.formation.spring.app.entities.Book;
import fr.formation.spring.app.refactoring.good.strategy.*;
import fr.formation.spring.app.refactoring.good.templatemethod.*;

import java.util.List;
import java.util.Map;

public class ReportingFacade {
    // On peut utiliser une Map pour une Factory simple
    private final Map&lt;String, AbstractReportGenerator&gt; reportGenerators;
    private final Map&lt;String, OutputStrategy&gt; outputStrategies;

    public ReportingFacade() {
        reportGenerators = Map.of(
                &quot;INVENTORY&quot;, new InventoryReportGenerator(),
                &quot;AUTHORS&quot;, new AuthorsReportGenerator()
        );
        outputStrategies = Map.of(
                &quot;HTML&quot;, new HtmlOutputStrategy(),
                &quot;PLAINTEXT&quot;, new PlainTextOutputStrategy()
        );
    }

    public void generateReport(String reportType, String format, List&lt;Book&gt; books) {
        AbstractReportGenerator generator = reportGenerators.get(reportType.toUpperCase());
        OutputStrategy outputStrategy = outputStrategies.get(format.toUpperCase());

        if (generator == null || outputStrategy == null) {
            System.err.println(&quot;Type de rapport ou format non supporté.&quot;);
            return;
        }

        System.out.println(&quot;--- DÉBUT (via Façade) ---&quot;);
        String content = generator.generate(books);
        outputStrategy.format(content);
        System.out.println(&quot;--- FIN (via Façade) ---&quot;);
    }
}
</div></section></section><section class="chapter"><h4 id="tape-4-le-code-client-propre-et-simple" data-toc="tape-4-le-code-client-propre-et-simple">&Eacute;tape 4 : Le code client, propre et simple</h4><div class="code-block" data-lang="java">
public class TestRefactoring {
    public static void main(String[] args) {
        // Le client ne connaît plus les détails complexes.
        ReportingFacade facade = new ReportingFacade();

        // Préparation des données... (non montré)
        List&lt;Book&gt; bookList = ...;

        System.out.println(&quot;&gt;&gt;&gt; Génération d'un rapport d'inventaire en HTML :&quot;);
        facade.generateReport(&quot;INVENTORY&quot;, &quot;HTML&quot;, bookList);

        System.out.println(&quot;\n&gt;&gt;&gt; Génération d'un rapport des auteurs en texte brut :&quot;);
        facade.generateReport(&quot;AUTHORS&quot;, &quot;PLAINTEXT&quot;, bookList);
    }
}
</div><p id="-5k3y2w_113">Nous avons transform&eacute; un code rigide et monolithique en un syst&egrave;me flexible, modulaire et facile &agrave; &eacute;tendre. C'est la puissance des Design Patterns en action.</p></section></section></section><section class="chapter"><h2 id="pour-aller-plus-loin" data-toc="pour-aller-plus-loin">Pour aller plus loin</h2><section class="chapter"><h3 id="la-danse-des-patterns-et-des-principes-s-o-l-i-d" data-toc="la-danse-des-patterns-et-des-principes-s-o-l-i-d">La Danse des Patterns et des Principes S.O.L.I.D.</h3><p id="-5k3y2w_116">Vous l'avez vu dans le refactoring : les patterns ne sont pas des inventions arbitraires. Ils sont souvent des applications concr&egrave;tes des principes S.O.L.I.D. Comprendre ce lien renforce votre intuition.</p><ul class="list _bullet" id="-5k3y2w_117"><li class="list__item" id="-5k3y2w_118"><p id="-5k3y2w_123"><span class="control" id="-5k3y2w_125">S - Single Responsibility Principle :</span></p><ul class="list _bullet" id="-5k3y2w_124"><li class="list__item" id="-5k3y2w_126"><p id="-5k3y2w_128"><span class="control" id="-5k3y2w_129">Facade :</span> La fa&ccedil;ade a la seule responsabilit&eacute; de simplifier l'acc&egrave;s. Les classes du sous-syst&egrave;me gardent leurs propres responsabilit&eacute;s.</p></li><li class="list__item" id="-5k3y2w_127"><p id="-5k3y2w_130"><span class="control" id="-5k3y2w_131">Command :</span> Une commande a la seule responsabilit&eacute; d'encapsuler une requ&ecirc;te.</p></li></ul></li><li class="list__item" id="-5k3y2w_119"><p id="-5k3y2w_132"><span class="control" id="-5k3y2w_134">O - Open/Closed Principle :</span> C'est le principe roi pour beaucoup de patterns.</p><ul class="list _bullet" id="-5k3y2w_133"><li class="list__item" id="-5k3y2w_135"><p id="-5k3y2w_137"><span class="control" id="-5k3y2w_138">Strategy, Observer, Decorator :</span> Ils permettent d'ajouter de nouveaux comportements (strat&eacute;gies, observateurs, d&eacute;corations) en ajoutant de nouvelles classes, sans modifier le code client.</p></li><li class="list__item" id="-5k3y2w_136"><p id="-5k3y2w_139"><span class="control" id="-5k3y2w_140">Template Method :</span> Permet d'&eacute;tendre un algorithme sans modifier son squelette.</p></li></ul></li><li class="list__item" id="-5k3y2w_120"><p id="-5k3y2w_141"><span class="control" id="-5k3y2w_143">L - Liskov Substitution Principle :</span></p><ul class="list _bullet" id="-5k3y2w_142"><li class="list__item" id="-5k3y2w_144"><p id="-5k3y2w_145">Le fondement de tous les patterns bas&eacute;s sur le polymorphisme. Une <code class="code" id="-5k3y2w_146">ConcreteStrategy</code> doit pouvoir remplacer l'interface <code class="code" id="-5k3y2w_147">Strategy</code> sans casser le programme. Idem pour <code class="code" id="-5k3y2w_148">State</code>, <code class="code" id="-5k3y2w_149">Observer</code>, etc.</p></li></ul></li><li class="list__item" id="-5k3y2w_121"><p id="-5k3y2w_150"><span class="control" id="-5k3y2w_152">I - Interface Segregation Principle :</span></p><ul class="list _bullet" id="-5k3y2w_151"><li class="list__item" id="-5k3y2w_153"><p id="-5k3y2w_155"><span class="control" id="-5k3y2w_156">Adapter :</span> Le client d&eacute;pend de l'interface <code class="code" id="-5k3y2w_157">Target</code> qui est petite et sp&eacute;cifique &agrave; son besoin, pas de la grosse interface potentielle de l' <code class="code" id="-5k3y2w_158">Adaptee</code>.</p></li><li class="list__item" id="-5k3y2w_154"><p id="-5k3y2w_159"><span class="control" id="-5k3y2w_160">Observer :</span> L'interface <code class="code" id="-5k3y2w_161">Observer</code> est souvent tr&egrave;s petite (<code class="code" id="-5k3y2w_162">update()</code>), ne for&ccedil;ant pas les observateurs &agrave; impl&eacute;menter des m&eacute;thodes dont ils n'ont pas besoin.</p></li></ul></li><li class="list__item" id="-5k3y2w_122"><p id="-5k3y2w_163"><span class="control" id="-5k3y2w_165">D - Dependency Inversion Principle :</span></p><ul class="list _bullet" id="-5k3y2w_164"><li class="list__item" id="-5k3y2w_166"><p id="-5k3y2w_168"><span class="control" id="-5k3y2w_169">Factory Method, Abstract Factory :</span> Le client d&eacute;pend d'une abstraction (interface <code class="code" id="-5k3y2w_170">Product</code> ou <code class="code" id="-5k3y2w_171">AbstractFactory</code>), pas d'une impl&eacute;mentation concr&egrave;te. La fabrique se charge de l'inversion de d&eacute;pendance.</p></li><li class="list__item" id="-5k3y2w_167"><p id="-5k3y2w_172"><span class="control" id="-5k3y2w_173">Strategy, State :</span> Le <code class="code" id="-5k3y2w_174">Context</code> d&eacute;pend de l'interface <code class="code" id="-5k3y2w_175">Strategy</code> ou <code class="code" id="-5k3y2w_176">State</code>, pas des impl&eacute;mentations concr&egrave;tes.</p></li></ul></li></ul></section><section class="chapter"><h3 id="les-anti-patterns-les-pi-ges-viter" data-toc="les-anti-patterns-les-pi-ges-viter">Les Anti-Patterns : Les Pi&egrave;ges &agrave; &Eacute;viter</h3><p id="-5k3y2w_177">Un anti-pattern est une solution couramment utilis&eacute;e &agrave; un probl&egrave;me, mais qui est inefficace et cr&eacute;e plus de probl&egrave;mes qu'elle n'en r&eacute;sout.</p><div class="tabs" id="-5k3y2w_178" data-anchors="[-5k3y2w_179,-5k3y2w_180,-5k3y2w_181]"><div class="tabs__content" data-gtm="tab" id="-5k3y2w_179" data-title="The Golden Hammer (Le Marteau d'Or)"><p id="-5k3y2w_182"><b id="-5k3y2w_185">Description :</b> C'est l'anti-pattern du &quot;je viens d'apprendre un nouveau truc cool et je vais l'utiliser PARTOUT&quot;. Si vous venez de ma&icirc;triser le pattern Strategy, vous risquez de l'appliquer m&ecirc;me l&agrave; o&ugrave; un simple <code class="code" id="-5k3y2w_186">if</code> suffirait.</p><p id="-5k3y2w_183"><b id="-5k3y2w_187">Sympt&ocirc;me :</b> Sur-ing&eacute;nierie (over-engineering). Des solutions inutilement complexes pour des probl&egrave;mes simples.</p><p id="-5k3y2w_184"><b id="-5k3y2w_188">Rem&egrave;de :</b> Gardez votre esprit critique. Demandez-vous toujours : &quot;Est-ce que la complexit&eacute; ajout&eacute;e par ce pattern est justifi&eacute;e par la flexibilit&eacute; que j'y gagne ?&quot;. Le principe <b id="-5k3y2w_189">YAGNI</b> (&quot;You Ain't Gonna Need It&quot; - Tu n'en auras pas besoin) est votre meilleur ami.</p></div><div class="tabs__content" data-gtm="tab" id="-5k3y2w_180" data-title="God Object / God Class (Objet Divin)"><p id="-5k3y2w_190"><b id="-5k3y2w_193">Description :</b> Une classe qui sait tout et fait tout. C'est l'exact oppos&eacute; du Principe de Responsabilit&eacute; Unique.</p><p id="-5k3y2w_191"><b id="-5k3y2w_194">Sympt&ocirc;me :</b> Des classes de plusieurs milliers de lignes, avec des dizaines de m&eacute;thodes et de d&eacute;pendances. Elles sont impossibles &agrave; tester et &agrave; maintenir.</p><p id="-5k3y2w_192"><b id="-5k3y2w_195">Rem&egrave;de :</b> Le refactoring ! Utilisez des patterns comme <b id="-5k3y2w_196">Facade</b> pour cacher la complexit&eacute;, et extrayez des responsabilit&eacute;s dans de nouvelles classes plus petites (potentiellement en utilisant <b id="-5k3y2w_197">Strategy</b>, <b id="-5k3y2w_198">Command</b>, etc.).</p></div><div class="tabs__content" data-gtm="tab" id="-5k3y2w_181" data-title="Singletonitis (La Singleton-ite)"><p id="-5k3y2w_199"><b id="-5k3y2w_202">Description :</b> L'abus du pattern Singleton. Utiliser des singletons pour tout et n'importe quoi, simplement pour avoir un acc&egrave;s global facile.</p><p id="-5k3y2w_200"><b id="-5k3y2w_203">Sympt&ocirc;me :</b> Un code difficile &agrave; tester (comment mocker un appel statique &agrave; <code class="code" id="-5k3y2w_204">MySingleton.getInstance()</code>?), un couplage fort, et un &eacute;tat global cach&eacute; qui peut provoquer des effets de bord impr&eacute;visibles.</p><p id="-5k3y2w_201"><b id="-5k3y2w_205">Rem&egrave;de :</b> L' <b id="-5k3y2w_206">Inversion de Contr&ocirc;le (IoC)</b> et l' <b id="-5k3y2w_207">Injection de D&eacute;pendances</b>. Au lieu que votre classe aille chercher sa d&eacute;pendance (`getInstance()`), la d&eacute;pendance lui est fournie (via un constructeur). Les frameworks comme Spring font &ccedil;a pour vous. La plupart du temps, un bean avec une port&eacute;e &quot;singleton&quot; dans Spring est une bien meilleure solution qu'un Singleton manuel.</p></div></div></section></section><section class="chapter"><h2 id="auto-valuation" data-toc="auto-valuation">Auto-&eacute;valuation</h2><p id="-5k3y2w_208">Consolidons ces notions avanc&eacute;es.</p><aside class="prompt" data-type="warning" data-title="" id="-5k3y2w_209"><p>Les corrections de cette auto-&eacute;valuation se trouvent &agrave; la fin de l'ensemble du support de cours.</p></aside><p id="-5k3y2w_210"><span class="control" id="-5k3y2w_214">Questions &agrave; Choix Multiple (QCM)</span></p><ol class="list _decimal" id="-5k3y2w_211" type="1"><li class="list__item" id="-5k3y2w_215"><p id="-5k3y2w_219">Vous trouvez dans une base de code une m&eacute;thode de 500 lignes contenant de multiples <code class="code" id="-5k3y2w_221">if/else</code> imbriqu&eacute;s. Quel est le &quot;code smell&quot; le plus &eacute;vident ?</p><ul class="list _bullet" id="-5k3y2w_220"><li class="list__item" id="-5k3y2w_222"><p id="-5k3y2w_226">a) Duplication de code</p></li><li class="list__item" id="-5k3y2w_223"><p id="-5k3y2w_227">b) Long Method</p></li><li class="list__item" id="-5k3y2w_224"><p id="-5k3y2w_228">c) Lazy Class</p></li><li class="list__item" id="-5k3y2w_225"><p id="-5k3y2w_229">d) Data Clump</p></li></ul></li><li class="list__item" id="-5k3y2w_216"><p id="-5k3y2w_230">Le Principe Ouvert/Ferm&eacute; (OCP) est particuli&egrave;rement bien illustr&eacute; par quel trio de patterns ?</p><ul class="list _bullet" id="-5k3y2w_231"><li class="list__item" id="-5k3y2w_232"><p id="-5k3y2w_236">a) Singleton, Builder, Prototype</p></li><li class="list__item" id="-5k3y2w_233"><p id="-5k3y2w_237">b) Facade, Adapter, Proxy</p></li><li class="list__item" id="-5k3y2w_234"><p id="-5k3y2w_238">c) Strategy, Decorator, Observer</p></li><li class="list__item" id="-5k3y2w_235"><p id="-5k3y2w_239">d) Command, State, Memento</p></li></ul></li><li class="list__item" id="-5k3y2w_217"><p id="-5k3y2w_240">Un d&eacute;veloppeur de votre &eacute;quipe utilise le pattern Strategy pour g&eacute;rer un choix entre deux options qui ne changeront jamais. C'est un exemple probable de quel anti-pattern ?</p><ul class="list _bullet" id="-5k3y2w_241"><li class="list__item" id="-5k3y2w_242"><p id="-5k3y2w_246">a) God Object</p></li><li class="list__item" id="-5k3y2w_243"><p id="-5k3y2w_247">b) Singletonitis</p></li><li class="list__item" id="-5k3y2w_244"><p id="-5k3y2w_248">c) Spaghetti Code</p></li><li class="list__item" id="-5k3y2w_245"><p id="-5k3y2w_249">d) The Golden Hammer</p></li></ul></li><li class="list__item" id="-5k3y2w_218"><p id="-5k3y2w_250">Quelle est la meilleure alternative moderne &agrave; l'impl&eacute;mentation manuelle du pattern Singleton dans une application Spring ?</p><ul class="list _bullet" id="-5k3y2w_251"><li class="list__item" id="-5k3y2w_252"><p id="-5k3y2w_256">a) Cr&eacute;er une classe statique.</p></li><li class="list__item" id="-5k3y2w_253"><p id="-5k3y2w_257">b) Utiliser l'injection de d&eacute;pendances et la port&eacute;e &quot;singleton&quot; des beans Spring.</p></li><li class="list__item" id="-5k3y2w_254"><p id="-5k3y2w_258">c) Utiliser le pattern Prototype.</p></li><li class="list__item" id="-5k3y2w_255"><p id="-5k3y2w_259">d) Utiliser une variable globale.</p></li></ul></li></ol><p id="-5k3y2w_212"><span class="control" id="-5k3y2w_260">Questions Ouvertes</span></p><ol class="list _decimal" id="-5k3y2w_213" type="1" start="5"><li class="list__item" id="-5k3y2w_261"><p id="-5k3y2w_263">Expliquez pourquoi le refactoring est un processus it&eacute;ratif et pourquoi il est important d'avoir une bonne suite de tests avant de commencer &agrave; refactorer.</p></li><li class="list__item" id="-5k3y2w_262"><p id="-5k3y2w_264">Donnez un exemple de situation o&ugrave; l'utilisation d'une Facade pourrait &ecirc;tre un &quot;pansement&quot; sur une mauvaise conception, et o&ugrave; un refactoring plus profond du sous-syst&egrave;me serait pr&eacute;f&eacute;rable.</p></li></ol></section><section class="chapter"><h2 id="conclusion" data-toc="conclusion">Conclusion</h2><p id="-5k3y2w_265">Ce chapitre &eacute;tait peut-&ecirc;tre le plus important de tous. Conna&icirc;tre les patterns, c'est bien. Savoir quand, pourquoi et comment les utiliser &ndash; et quand ne PAS les utiliser &ndash; c'est ce qui fait un excellent concepteur.</p><p id="-5k3y2w_266">Vous avez appris &agrave; :</p><ul class="list _bullet" id="-5k3y2w_267"><li class="list__item" id="-5k3y2w_269"><p id="-5k3y2w_273"><span class="control" id="-5k3y2w_274">Diagnostiquer</span> un code malade en identifiant les &quot;code smells&quot;.</p></li><li class="list__item" id="-5k3y2w_270"><p id="-5k3y2w_275"><span class="control" id="-5k3y2w_276">Gu&eacute;rir</span> ce code en appliquant une combinaison de patterns (Strategy, Template Method, Facade) pour le rendre flexible et maintenable.</p></li><li class="list__item" id="-5k3y2w_271"><p id="-5k3y2w_277"><span class="control" id="-5k3y2w_278">Connecter</span> la th&eacute;orie (S.O.L.I.D.) &agrave; la pratique (Patterns).</p></li><li class="list__item" id="-5k3y2w_272"><p id="-5k3y2w_279"><span class="control" id="-5k3y2w_280">Reconna&icirc;tre</span> les pi&egrave;ges des anti-patterns pour ne pas tomber dedans.</p></li></ul><p id="-5k3y2w_268">Vous &ecirc;tes maintenant &eacute;quip&eacute; non seulement des outils, mais aussi du discernement pour les utiliser. Le dernier module sera une conclusion rapide, un r&eacute;capitulatif de notre voyage et des pistes pour continuer &agrave; apprendre toute votre vie.</p></section><div class="last-modified">25 juillet 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="004-00-behaviour-patterns.html" class="navigation-links__prev">Les Patterns Comportementaux : L'Art de la Communication entre Objets</a><a href="020-00-conclusion.html" class="navigation-links__next">Conclusion et Prochaines &Eacute;tapes</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>